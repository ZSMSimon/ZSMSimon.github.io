<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="baidu-site-verification" content="w9Akh6dPe4" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<!--[if lte IE 8]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]-->

<title>深入理解unslider.js源码 | 曾绍明的博客</title>
<meta name="author" content="曾绍明">

  <meta name="keywords" content="unslider,js,jquery">




<link rel="shortcut icon" href="" />

<link rel="stylesheet" type="text/css" href="/assets/css/style.css">

<link href="/pages/rss.xml" rel="alternate" title="曾绍明的博客" type="application/atom+xml">



  </head>
  <body>
        <aside id="sidebar">
  <nav id="tags">
    <a href="/index.html" id="avatar" style="background-image:url(https://avatars1.githubusercontent.com/u/15245912)"></a>

    <ul id="tags__ul">
      <li id="pl__all" class="tags__li tags-btn active">所有文章</li>
       
        <li id="技术" class="tags__li tags-btn">技术</li>
       
        <li id="web前端" class="tags__li tags-btn">web前端</li>
       
        <li id="专题" class="tags__li tags-btn">专题</li>
       
        <li id="iOS" class="tags__li tags-btn">iOS</li>
       
        <li id="生活" class="tags__li tags-btn">生活</li>
       
        <li id="react-native" class="tags__li tags-btn">react-native</li>
       
        <li id="其他" class="tags__li tags-btn">其他</li>
       
        <li id="IoT" class="tags__li tags-btn">IoT</li>
      
    </ul>

    <div id="tags__bottom">
      <a href="http://github.com/ZSMSimon" id="icon-github" class="tags-btn fontello" target="_blank"></a>
      <a href="/pages/rss.xml" id="icon-feed" class="tags-btn fontello" target="_blank"></a>
      <a href="mailto:ZSMSimon@163.com" id="icon-email" class="tags-btn fontello"></a>
    </div>
  </nav> <!-- end #tags -->

  <div id="posts-list">
    <form action="" id="search-form">
      <a href="/index.html" id="mobile-avatar" style="background-image:url(https://avatars1.githubusercontent.com/u/15245912)"></a>
      <!-- NOTE: input field is disabled by default -->
      <input id="search-input" type="text" placeholder="Search..." >
    </form>

    <nav id="pl__container">
    
      <a class="IoT pl__all" href="/2017/05/16/JavaScript-mqtt-temperaturedemo.html"><span class="pl__circle"></span><span class="pl__title">IoT技术选型及模型设计的思考</span><span class="pl__date">17/05/16</span></a>
    
      <a class="IoT pl__all" href="/2017/05/02/hello-nodemcu.html"><span class="pl__circle"></span><span class="pl__title">hello nodemcu</span><span class="pl__date">17/05/02</span></a>
    
      <a class="其他 pl__all" href="/2017/03/16/Recruitment.html"><span class="pl__circle"></span><span class="pl__title">阿里云iot事业部招聘信息</span><span class="pl__date">17/03/16</span></a>
    
      <a class="技术 pl__all" href="/2017/01/23/zhihu-live-a-hour-for-bluetooth-0.html"><span class="pl__circle"></span><span class="pl__title">知乎live：一小时蓝牙科普 文字整理版</span><span class="pl__date">17/01/23</span></a>
    
      <a class="web前端 pl__all" href="/2016/12/08/eslint-guide.html"><span class="pl__circle"></span><span class="pl__title">ESLint使用</span><span class="pl__date">16/12/08</span></a>
    
      <a class="其他 pl__all" href="/2016/12/06/how-to-fupan.html"><span class="pl__circle"></span><span class="pl__title">柳传志：我的复盘方法论</span><span class="pl__date">16/12/06</span></a>
    
      <a class="react-native pl__all" href="/2016/11/14/react-native-flux%E6%95%B0%E6%8D%AE%E6%B5%81.html"><span class="pl__circle"></span><span class="pl__title">flux数据流在rn中的使用</span><span class="pl__date">16/11/14</span></a>
    
      <a class="专题 pl__all" href="/2016/05/09/iOS-networking-0.html"><span class="pl__circle"></span><span class="pl__title">iOS 网络请求专题</span><span class="pl__date">16/05/09</span></a>
    
      <a class="iOS pl__all" href="/2016/04/03/iOS-JavaScriptCore.html"><span class="pl__circle"></span><span class="pl__title">iOS JavaScriptCore使用</span><span class="pl__date">16/04/03</span></a>
    
      <a class="iOS pl__all" href="/2016/04/02/iOS-3DTouch-3.html"><span class="pl__circle"></span><span class="pl__title">iOS 3D touch开发(三) Force Properties-按压力度</span><span class="pl__date">16/04/02</span></a>
    
      <a class="iOS pl__all" href="/2016/04/01/iOS-3DTouch-2.html"><span class="pl__circle"></span><span class="pl__title">iOS 3D touch开发(二) peek and pop - 预览和弹出</span><span class="pl__date">16/04/01</span></a>
    
      <a class="iOS pl__all" href="/2016/03/21/iOS-3DTouch-1.html"><span class="pl__circle"></span><span class="pl__title">iOS 3D touch开发(一) Home Screen Quick Actions</span><span class="pl__date">16/03/21</span></a>
    
      <a class="iOS pl__all" href="/2016/03/10/iOS-unit-test.html"><span class="pl__circle"></span><span class="pl__title">iOS单元测试</span><span class="pl__date">16/03/10</span></a>
    
      <a class="iOS pl__all" href="/2016/02/29/iOS-objc-styleguide.html"><span class="pl__circle"></span><span class="pl__title">iOS objc编程规范</span><span class="pl__date">16/02/29</span></a>
    
      <a class="iOS pl__all" href="/2016/02/13/ios-networking-5.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（五）网络请求中的cookie</span><span class="pl__date">16/02/13</span></a>
    
      <a class="iOS pl__all" href="/2016/02/09/ios-networking-4.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（四） http异步文件上传和下载以及进度指示</span><span class="pl__date">16/02/09</span></a>
    
      <a class="iOS pl__all" href="/2016/02/04/ios-networking-3.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（三） http异步请求和https认证</span><span class="pl__date">16/02/04</span></a>
    
      <a class="iOS pl__all" href="/2016/02/03/ios-networking-2.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（二） http异步队列请求</span><span class="pl__date">16/02/03</span></a>
    
      <a class="iOS pl__all" href="/2016/02/03/ios-networking-1.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（一） http同步请求</span><span class="pl__date">16/02/03</span></a>
    
      <a class="react-native pl__all" href="/2016/02/02/react-native-demo.html"><span class="pl__circle"></span><span class="pl__title">react-native（二） 自己写的react-native学习demo和整理的tips</span><span class="pl__date">16/02/02</span></a>
    
      <a class="react-native pl__all" href="/2016/01/11/react-native-helloworld.html"><span class="pl__circle"></span><span class="pl__title">react-native（一） hello world</span><span class="pl__date">16/01/11</span></a>
    
      <a class="iOS pl__all" href="/2016/01/06/iOS-app-versions.html"><span class="pl__circle"></span><span class="pl__title">api如何设计才能支撑多个不同版本的app共存</span><span class="pl__date">16/01/06</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/31/playwith-imageToAscii.html"><span class="pl__circle"></span><span class="pl__title">那些好玩的nodejs插件 - 把图片转为ascii</span><span class="pl__date">15/12/31</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/10/fe-componentization.html"><span class="pl__circle"></span><span class="pl__title">前端开发框架 - seajs+handlebars模块化开发</span><span class="pl__date">15/12/10</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/06/fe-nginx-usage.html"><span class="pl__circle"></span><span class="pl__title">mac环境nginx的安装和使用</span><span class="pl__date">15/12/06</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/03/fe-js-handlebars.html"><span class="pl__circle"></span><span class="pl__title">handlerbars的使用及模板预编译</span><span class="pl__date">15/12/03</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/01/fe-engineering-gulp.html"><span class="pl__circle"></span><span class="pl__title">gulp自动构建工具教程</span><span class="pl__date">15/12/01</span></a>
    
      <a class="web前端 pl__all" href="/2015/11/27/fe-environment.html"><span class="pl__circle"></span><span class="pl__title">前端开发工具和环境搭建</span><span class="pl__date">15/11/27</span></a>
    
      <a class="web前端 pl__all" href="/2015/11/26/rem-em-px.html"><span class="pl__circle"></span><span class="pl__title">css3属性rem的使用</span><span class="pl__date">15/11/26</span></a>
    
      <a class="生活 pl__all" href="/2015/11/26/mylift-github.html"><span class="pl__circle"></span><span class="pl__title">我每天都在github上做些什么</span><span class="pl__date">15/11/26</span></a>
    
      <a class="iOS pl__all" href="/2015/11/24/iOS-affine-transfermation-animation.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（七）仿射变换-CGAffineTransform</span><span class="pl__date">15/11/24</span></a>
    
      <a class="iOS pl__all" href="/2015/11/22/iOS-library-spring.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（六）swift动画库spring使用和代码拆解</span><span class="pl__date">15/11/22</span></a>
    
      <a class="iOS pl__all" href="/2015/11/16/iOS-Implicit-Animation.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（五）layer隐式动画</span><span class="pl__date">15/11/16</span></a>
    
      <a class="iOS pl__all" href="/2015/11/06/iOS-controller-transitioning.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（四）controller间的自定义过渡效果</span><span class="pl__date">15/11/06</span></a>
    
      <a class="iOS pl__all" href="/2015/11/01/iOS-MotionEffects.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（三）MotionEffects</span><span class="pl__date">15/11/01</span></a>
    
      <a class="iOS pl__all" href="/2015/10/30/iOS-UIKit-Dynamics.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（二）UIKit力学行为</span><span class="pl__date">15/10/30</span></a>
    
      <a class="iOS pl__all" href="/2015/10/30/iOS-Animation-UIViewAndCoreAnimation.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（一）UIView动画和CoreAnimation</span><span class="pl__date">15/10/30</span></a>
    
      <a class="专题 pl__all" href="/2015/10/29/iOS-animation-0.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效专题（零）- 大纲和计划</span><span class="pl__date">15/10/29</span></a>
    
      <a class="iOS pl__all" href="/2015/10/17/ios-webView.html"><span class="pl__circle"></span><span class="pl__title">UIWebView和WKWebView的使用及js交互</span><span class="pl__date">15/10/17</span></a>
    
      <a class="iOS pl__all" href="/2015/10/06/ios-swift-quick.html"><span class="pl__circle"></span><span class="pl__title">swift5分钟语法速记</span><span class="pl__date">15/10/06</span></a>
    
      <a class="iOS pl__all" href="/2015/09/20/ios-macro.html"><span class="pl__circle"></span><span class="pl__title">ios宏的使用和技巧</span><span class="pl__date">15/09/20</span></a>
    
      <a class="iOS pl__all" href="/2015/09/11/ios-BLE-4.html"><span class="pl__circle"></span><span class="pl__title">ios蓝牙开发（四）BabyBluetooth蓝牙库介绍</span><span class="pl__date">15/09/11</span></a>
    
      <a class="iOS pl__all" href="/2015/09/07/ios-BLE-3.html"><span class="pl__circle"></span><span class="pl__title">ios蓝牙开发（三）app作为外设被连接的实现</span><span class="pl__date">15/09/07</span></a>
    
      <a class="iOS pl__all" href="/2015/09/02/ios-draw-Graffiti-2.html"><span class="pl__circle"></span><span class="pl__title">ios绘图demo,做一个涂鸦板(下)</span><span class="pl__date">15/09/02</span></a>
    
      <a class="web前端 pl__all" href="/2015/08/29/go-deep-into-unsilder.js.html"><span class="pl__circle"></span><span class="pl__title">深入理解unslider.js源码</span><span class="pl__date">15/08/29</span></a>
    
      <a class="生活 pl__all" href="/2015/08/23/life-keyboardAndHHKB.html"><span class="pl__circle"></span><span class="pl__title">键盘那些事，hhkb开箱</span><span class="pl__date">15/08/23</span></a>
    
      <a class="技术 pl__all" href="/2015/08/22/github-ImagesUploadWebSite.html"><span class="pl__circle"></span><span class="pl__title">自己markdown博客的图床程序</span><span class="pl__date">15/08/22</span></a>
    
      <a class="iOS pl__all" href="/2015/08/19/ios-ThreadAndAsynchronization.html"><span class="pl__circle"></span><span class="pl__title">ios的线程和同步异步操作</span><span class="pl__date">15/08/19</span></a>
    
      <a class="iOS pl__all" href="/2015/08/14/ios-BLE-2.html"><span class="pl__circle"></span><span class="pl__title">ios蓝牙开发（二）ios连接外设的代码实现</span><span class="pl__date">15/08/14</span></a>
    
      <a class="iOS pl__all" href="/2015/07/26/ios-draw-Graffiti.html"><span class="pl__circle"></span><span class="pl__title">ios绘图demo,做一个涂鸦板(上)</span><span class="pl__date">15/07/26</span></a>
    
      <a class="iOS pl__all" href="/2015/07/25/ios-draw-base.html"><span class="pl__circle"></span><span class="pl__title">ios绘图基础</span><span class="pl__date">15/07/25</span></a>
    
      <a class="iOS pl__all" href="/2015/07/17/ios-BLE-1.html"><span class="pl__circle"></span><span class="pl__title">iOS蓝牙开发（一）蓝牙相关基础知识</span><span class="pl__date">15/07/17</span></a>
    
      <a class="专题 pl__all" href="/2015/07/17/ios-BLE-0.html"><span class="pl__circle"></span><span class="pl__title">iOS蓝牙的开发专题</span><span class="pl__date">15/07/17</span></a>
    
      <a class="技术 pl__all" href="/2015/07/07/mybatis.html"><span class="pl__circle"></span><span class="pl__title">MyBatis简单使用的demo</span><span class="pl__date">15/07/07</span></a>
    
      <a class="技术 pl__all" href="/2015/07/06/rabbitmq.html"><span class="pl__circle"></span><span class="pl__title">RabbitMQ使用</span><span class="pl__date">15/07/06</span></a>
    
      <a class="iOS pl__all" href="/2015/06/14/ios-library-masonry.html"><span class="pl__circle"></span><span class="pl__title">Masonry的使用</span><span class="pl__date">15/06/14</span></a>
    
      <a class="专题 pl__all" href="/2015/06/14/ios-library-0.html"><span class="pl__circle"></span><span class="pl__title">iOS中那些好用的第三方库</span><span class="pl__date">15/06/14</span></a>
    
      <a class="iOS pl__all" href="/2015/05/29/ios-develop-tool.html"><span class="pl__circle"></span><span class="pl__title">提高iOS开发效率的工具</span><span class="pl__date">15/05/29</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-4.html"><span class="pl__circle"></span><span class="pl__title">Spring 文件上传</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-3.html"><span class="pl__circle"></span><span class="pl__title">Spring- Hibernate数据基本操作</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-2.html"><span class="pl__circle"></span><span class="pl__title">Spring RestController 请求参数详解</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-1.html"><span class="pl__circle"></span><span class="pl__title">Spring和hibernate的maven配置</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/tomcat-domain-name.html"><span class="pl__circle"></span><span class="pl__title">tomcat部署绑定多个域名</span><span class="pl__date">15/05/28</span></a>
    
      <a class="专题 pl__all" href="/2015/05/28/spring-0.html"><span class="pl__circle"></span><span class="pl__title">Spring4+hibernate专题</span><span class="pl__date">15/05/28</span></a>
    
      <a class="web前端 pl__all" href="/2015/04/29/css-selector.html"><span class="pl__circle"></span><span class="pl__title">css选择器的用法</span><span class="pl__date">15/04/29</span></a>
    
      <a class="技术 pl__all" href="/2014/02/12/how-to-deploy-a-blog-on-github-by-jekyll.html"><span class="pl__circle"></span><span class="pl__title">在Github上搭建Jekyll博客和创建主题</span><span class="pl__date">14/02/12</span></a>
    
      <a class="技术 pl__all" href="/2013/04/23/opensource-licenses.html"><span class="pl__circle"></span><span class="pl__title">五中常见的开源协议整理(BSD,Apache,GPL,LGPL,MIT)</span><span class="pl__date">13/04/23</span></a>
    
    </nav>
  </div> <!-- end #posts-list -->
</aside> <!-- end #sidebar -->
    <div id="post">
      <div id="pjax">
        <article id="post__content">
    <h1 id="post__title" data-identifier="20150829">深入理解unslider.js源码</h1>
    <blockquote>
  <p>最近用到了一个挺好用的幻灯片插件，叫做unslider.js,就想看看怎么实现幻灯片功能，就看看源码，顺便自己也学习学习。看完之后收获很多，这里和大家分享一下。</p>
</blockquote>

<p>unslider.js 源码和使用教程可以在他<a href="https://github.com/idiot/unslider">github</a>库 和<a href="http://unslider.com/">unslider官网</a> 中找到</p>

<p>大纲</p>

<ul>
  <li>unslider.js使用</li>
  <li>unslider.js库的代码结构</li>
  <li>unslider.js库的实现</li>
  <li>总结unslider.js源码中值得我们学习的点</li>
</ul>

<p>代码下载:github库，对应此文章的目录是DeepIntoUnslider ,<a href="https://github.com/coolnameismy/demo">点击跳转代码下载地址</a></p>

<h2 id="一unsliderjs使用">(一)unslider.js使用</h2>
<hr />

<p>unslider.js用起来很简单。</p>

<ol>
  <li>
    <p>引入juqery 和 unslider.js</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;script type="text/javascript" src="js/jquery-1.10.1.min.js"&gt; &lt;/script&gt;
 &lt;script type="text/javascript" src="js/unslider.js"&gt; &lt;/script&gt;
</code></pre></div>    </div>
  </li>
  <li>
    <p>写html和css</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;div class="banner"&gt;
    &lt;ul &gt;
        &lt;li style=" background-image: url(http://unslider.com/img/sunset.jpg);"&gt;&lt;/li&gt;
        &lt;li style=" background-image: url(http://unslider.com/img/wood.jpg);"&gt;&lt;/li&gt;
        &lt;li style="background-image: url(http://unslider.com/img/subway.jpg);"&gt;&lt;/li&gt;
        &lt;li style="background-image: url(http://unslider.com/img/subway.jpg);"&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
</code></pre></div>    </div>

    <p>css 省略，可以看我的demo</p>
  </li>
  <li>
    <p>js初始化unslider</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$(function() {
        unslider = $('.banner').unslider({
            speed: 500,               //  切换的速度
            delay: 3000,              //  切换的速度
            keys: true,               //  是否启用左右按钮控制slider切换
            fluid: false,              // 是否每次在容器大小改变的时候，修正slider的大小
            pause:true,                 //鼠标以上去是否暂停播放
            starting:function(){        //每次开始切换时回叫方法
                console.log("starting");
            },
            complete:function(){         //每次完成切换时回叫方法
                console.log("complete");
            },
            arrows: true,               //  是否显示左右箭头，用于slider切换
            dots: true                  //  是否显示白色圆点，用于slider切换
        });
 });
</code></pre></div>    </div>
  </li>
  <li>
    <p>unslider方法调用</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var data = unslider.data('unslider');

// 开始
data.start();

// 暂停
data.stop();

//  切换至第n个 function是回调函数
data.move(2, function() {});
//  data.move(0);

 
//  切换下一个
data.next();

// 切换上一个
data.prev();
</code></pre></div>    </div>
  </li>
</ol>

<p>更多内容可以去<a href="http://unslider.com/">unslider官网</a> 查看。</p>

<h2 id="二-unsliderjs库的代码结构">（二） unslider.js库的代码结构</h2>
<hr />

<h4 id="1--先看unslider内部实现的结构">1.  先看Unslider内部实现的结构</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    (function($, f) {
        var Unslider = function() {
            ...（第三部分讲）
        };

        //  Create a jQuery plugin
        $.fn.unslider = function(o) {
            ...（第二部分讲）
        };

        Unslider.version = "1.0.0";
    })(jQuery, false);
</code></pre></div></div>

<p><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(function($, f) {})(jQuery, false);
</code></pre></div></div>

<p>这是js的匿名函数，匿名函数的调用。我们看个简单的</p>

<p>(function(i){ console.log(i)})(10)</p>

<p>把它在浏览器里面执行以下，会打印出数字10.</p>

<p>方法的前半句   function(i){ console.log(i)}   是定义了一个匿名函数，后半句（10）是调用了这个匿名函数。</p>

<p>所以 (function($, f) {})(jQuery, false) 就是定义了这样2个参数的方法，第一个参数是jquery对象</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $.fn.unslider = function(o) {

     };
</code></pre></div></div>

<p>这个是jquery的方法扩展，执行这个方法后就可以使用： $(‘.banner’).unslider(o) 的方式调用。o在unslider中就是你配置的各种参数</p>

<h4 id="2-fnunslider-的方法实现">2. $.fn.unslider 的方法实现</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $.fn.unslider = function(o) {
            var len = this.length;
            return this.each(function(index) {
                var me = $(this),
                        key = 'unslider' + (len &gt; 1 ? '-' + ++index : ''),
                        instance = (new Unslider).init(me, o);
            me.data(key, instance).data('key', key);
        });
    };
    Unslider.version = "1.0.0";
</code></pre></div></div>

<p><strong>return this.each(function(index) {})</strong></p>

<p>$.each是jquery的遍历工具方法，每次会返回function中的内容。这里用each主要是因为$(‘.banner’)对象是一个数组，这样可以把每一个.banner渲染为unslider，并且返回$(‘.banner’)。</p>

<p><strong>Unslider.version = “1.0.0”; 只是给Unslider 增加了一个版本号的属性</strong></p>

<p><strong>me.data(key, instance).data(‘key’, key)</strong></p>

<p>$.data方法是对dom元素数据的保存。 $.data(key)是取值，$.data(key,value)是赋值。</p>

<p>比如: <code class="highlighter-rouge">&lt;div data-key="abc"&gt;&lt;/div&gt; </code>  那么$(“div”).data(“key”)会返回”abc“。 $(“div”).data(“key”,”newkey”)会给key附上新值”newkey“。</p>

<p>但是请注意，dom元素上的data-key=”abc”不会变化，不过下次再取key值时候，会返回”newkey“了</p>

<p>unslider用$.data缓存了unslider的实例，所以在调用unslider的方法时，先要 <code class="highlighter-rouge">var data = unslider.data('unslider');</code>获取实例之后才调用方法。</p>

<p>多说一句：这里我不是很理解作者是怎么考虑的，作者让$.unslider方法返回一个jquery对象，而把实例缓存在$对象中。所以使用实例方法需要多一步转换。如果是我的话，我会直接让$.unslider返回unslider的实例，我会把
$.fn.unslider = function(o) {} 改成这样</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	$.fn.unslider = function(o) {
        var len = this.length,
            arr = [];
        Unslider.version = "1.0.0";

        this.each(function(index) {
            var me = $(this),
                key = 'unslider' + (len &gt; 1 ? '-' + ++index : ''),
                instance = (new Unslider).init(me, o);
            arr.push(instance);
        });
        // if single,return instance ，else return array of instance
        if(arr.length==1) return arr[0];
        return arr;
	};
</code></pre></div></div>

<h4 id="3--var-unslider--function--内部方法结构">3.  <code class="highlighter-rouge">var Unslider = function() {}</code> 内部方法结构</h4>

<p>unsliders一共定义了8个对象，分别是：o,init,to,play,stop,next,perv,nav</p>

<p><strong>o：unslider的配置对象，我翻译并解释了一下</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    _.o = {
        speed: 500,     // 切换时候的运动速度,false是不进行切换 (integer or boolean)
        delay: 3000,    // 切换的时间间隔，false是不自动切换 (integer or boolean)
        init: 0,        // 初始化时候的延迟，false为不延迟 (integer or boolean)
        pause: !f,      // 鼠标移上去的时候是否需要暂停切换 默认值是yes(boolean)
        loop: !f,       // 是否循环切换 (boolean)
        keys: f,        // 快捷键 (boolean)
        dots: f,        // 是否显现 可以切换的控制点  (boolean)
        arrows: f,      // 是否显现 上一页下一页的箭头 (boolean)
        prev: '&amp;larr;', // 上一页按钮的文字 (string)
        next: '&amp;rarr;', // 下一页按钮的文字
        fluid: f,       // 是否是一个百分比的宽度（boolean)
        starting: f,    // 开始切换时的回叫函数 (function)
        complete: f,    // 切换完成时候的回叫函数 (function)
        items: '&gt;ul',   // slides jquery选择容器的标签
        item: '&gt;li',    // slides items 选择容器的标签
        easing: 'swing',// 动画运动的方式    swing 或者linear，这个是由jquery $(selector).animate(styles,speed,easing,callback) 方法提供的参数。
        autoplay: true  // 自动播放
    };
</code></pre></div></div>

<p><strong>init:unsliders的构造方法，通过对这个方法传入jquery对象和unsliders的构造参数，生成一个unsliders的实例</strong></p>

<p><strong>to:切换sliders的方法，是实现幻灯切换的核心方法</strong></p>

<p><strong>play:定时调用to方法，切换到下一个</strong></p>

<p><strong>stop:取消play的定时器</strong></p>

<p><strong>next:立刻切换到下一个</strong></p>

<p><strong>prev:立刻切换到上一个</strong></p>

<p><strong>nav:构造silders中间的点样式和点击切换，以及左右箭头切换上一张下一张</strong></p>

<p>这样看下去，整个unslider.js的整体结构就都已经看清了，后面主要说一下init方法和to方法。</p>

<h2 id="三unsliderjs库的实现">（三）unslider.js库的实现</h2>
<hr />
<p>这里我只简单说说几个重要的方法，如果想看详细的每一步，可以打开<a href="https://github.com/coolnameismy/demo/blob/master/DeepIntoUnslider/js/unsliders.zh-cn.js">unsliders.zh-cn.js</a>进行阅读，我对unslider.js的每一步的实现做了中文翻译，并添加了一些注释。</p>

<h3 id="init方法">init方法：</h3>
<p>init方法开始时候通过<code class="highlighter-rouge">_.o = $.extend(_.o, o);</code>把你设定的unslider参数和默认参数进行了合并。$.extend参数有很多作用，后面还会说道。</p>

<p>接着修正了生成unslider容器的样式，构造dot和arrows（这两个东西主要是切换slider使用），开启了定时器调用play()方法</p>

<p>之后添加了一些扩展特性，都是通过option可配的。 1：对触摸屏左右滑动的支持（需要另外添加一个js文件。jquery.event.swipe.js）2：容器大小变化，修正slider的扩展 3：键盘左右控制unslider左右切换的支持</p>

<p>最后初始化完成之后，返回self</p>

<h3 id="to方法">to方法：</h3>

<p><strong>slider切换的原理</strong></p>

<p>slider是通过在ul中放置li，切换slider就是调整ulleft位置实现的。这样说还不是很明白，我来举个例子。</p>

<p>ul中有4个li，每个li的宽高是100px*100px ，那么就需要把ul的style设为{ height:100px;witdh:400px; position:relative;left:0px }</p>

<p>通过修改left这个css属性，left:0px 对应第一个li的位置，left=-100px对应第二个li的位置， left=-200px对应第三个li的位置，left=-300px对应第四个li的位置</p>

<p>在通过$.animate 方法修改left，这个slider切换就动了起来。</p>

<p><strong>to方法的实现</strong></p>

<p>首先刷新定时器。之后获取一大堆配置参数，比如使用设置了回调方法，切换时的速度，切换动画的方式（easing：swing 或者linear。这两个参数是jquery，animate方法的参数，运动方式会有区别，linear是线性匀速运动，swing是先，慢后快的运动。默认是swing，因为这种动画方式更自然）</p>

<p>最后执行切换slider的动画，并回执行切换完成的回调方法。</p>

<h3 id="其他方法">其他方法</h3>
<p>其他方法基本上都是对to方法的调用，和定时器的控制。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     // 自动播放
    _.play = function() {
        _.t = setInterval(function() {
            _.to(_.i + 1);
        }, _.o.delay | 0);
    };

    // 停止自动播放
    _.stop = function() {
        _.t = clearInterval(_.t);
        return _;
    };

    //立刻切换下一张
    _.next = function() {
        return _.stop().to(_.i + 1);
    };

    //回到上一张
    _.prev = function() {
        return _.stop().to(_.i - 1);
    };
</code></pre></div></div>

<h2 id="四总结unsliderjs源码中值得我们学习的点">（四）总结unslider.js源码中值得我们学习的点</h2>
<hr />

<p>unslider有很多我们值得学习的地方。</p>

<h3 id="1-标准js类库的写法">1 标准js类库的写法</h3>

<p><code class="highlighter-rouge">(function($, f) {})(jQuery, false)</code>和 <code class="highlighter-rouge">$.fn</code>：通过这两个方法，把js类库中的变量私有化，不会和外部变量冲突，$.fn扩展方法使用，使类库的调用更优雅。</p>

<h3 id="2-jquery工具函数的使用">2 jquery工具函数的使用：</h3>

<p>$.data ：缓存数据到jquery对象中</p>

<p>$.resize：监听容器尺寸变化</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        // 解决自适应 当屏幕大小变化时，会进入方法，重新校正容器的宽度和高度。
        o.fluid &amp;&amp; $(window).resize(function() {
            _.r &amp;&amp; clearTimeout(_.r);

            _.r = setTimeout(function() {
                var styl = {height: li.eq(_.i).outerHeight()},
                    width = el.outerWidth();

                ul.css(styl);
                styl['width'] = Math.min(Math.round((width / el.parent().width()) * 100), 100) + '%';
                el.css(styl);
                li.css({ width: width + 'px' });
            }, 50);
        }).resize();
</code></pre></div></div>

<p>-$.extend 用法。</p>

<p>(1)：jquery静态扩展对象。 例如 <code class="highlighter-rouge">$.extend({  test:function(){alert('test函数')}   })</code>执行后会增加一个 $.test方法</p>

<p>(2)：合并对象。 <code class="highlighter-rouge">-_.o = $.extend(_.o, o);</code></p>

<p>(3)：深层合并对象 <code class="highlighter-rouge">-_.o = $.extend(ture,_.o, o);</code> 这个方法和上面的方法的区别在于，o的每个属性的属性是否合并。对于location，只有用这个方法，才会保留下location的city和state</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    var obj = jQuery.extend( true,
         { name: "John", "location": { "city": "Boston" } },
         { last: "Resig", "location": { "state": "MA" } }
    );
</code></pre></div></div>

<p>-jquery.queue:</p>

<p>这里主要是函数队列的使用。可以定义一组队列，在实现方法串行调用的适合很有用。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    var FUNC=[
        function(){alert("方法1")},
        function(){alert("方法2")},
        function(){alert("方法3")},
        function(){alert("方法结束")}
    ];
    $(document).queue(FUNC);//存入队列，不指定队列名称时会设置默认名称为fx，并直接返回函数数组的第一个元素 alert("方法1")
    $(document).dequeue("fx");弹出队列第一个函数 ，会执行alert("方法2")  dequeue的时候必须指定队列名称
    $(document).queue("fx");//返回当前队列

    $(document).queue("q",FUNC);//存入队列，指定队列名称时不会返回函数数组的第一个元素
    $(document).dequeue("q");弹出队列第一个函数 ，会执行alert("方法1")
    $(document).queue("q");//返回当前队列
</code></pre></div></div>

<h3 id="3-精炼的语法">3 精炼的语法</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    //连续赋值
    var me = $(this),
        key = 'unslider' + (len &gt; 1 ? '-' + ++index : ''),
        instance = (new Unslider).init(me, o);

    //  &amp;&amp; 代替if语句
     o.dots &amp;&amp; nav('dot');

    //jquery的串行函数执行
    el.find('.dot').eq(index).addClass('active').siblings().removeClass('active');
</code></pre></div></div>

<p>感谢收看，如果对大家有帮助，请<a href="https://github.com/coolnameismy">github上follow和star</a>，本文发布在<a href="https://zsmsimon.github.io/">刘彦玮的技术博客</a>，转载请注明出处</p>

    <div class="declare">
        <div>

        </div>
    </div>
</article>
<!-- end #post__content -->

<div id="post__share">
  <a id="icon-twitter" class="fontello" href="https://twitter.com/intent/tweet?url=http://localhost:4000/2015/08/29/go-deep-into-unsilder.js.html&text=深入理解unslider.js源码" target="_blank"></a>
  <a id="icon-cc" class="fontello" href="http://github.com/ZSMSimon" target="_blank"></a>
  <a id="icon-weibo" class="fontello" href="http://v.t.sina.com.cn/share/share.php?url=http://localhost:4000/2015/08/29/go-deep-into-unsilder.js.html&title=深入理解unslider.js源码" target="_blank"></a>
    <!-- <div class="share-info">分享一下~</div> -->
</div>
<div id="qrcode" >
	<img src="http://localhost:4000/assets/images/qrcode.jpg" style="margin: 0 auto;display: block;" width="200" height="200" alt="">
</div>
<!-- end #post__share -->
<div id="disqus_thread" name="coolnameismy">
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink" target="_blank">Loading Disqus comments...</a>
</div>


            <!---->
    <!--<p id="copyright">Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>-->
    <!--&nbsp;&nbsp;|&nbsp;&nbsp;Theme <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll</a>-->
    <!--&nbsp;&nbsp;|&nbsp;&nbsp;Hosted on <a href="https://pages.github.com" target="_blank">Github</a></p>-->
      </div> <!-- end #pjax -->

      <div id="post__toc-trigger">
        <div id="post__toc">
          <span id="post__toc-title">Table of Contents</span>
          <ul id="post__toc-ul"></ul>
        </div>
      </div>
    </div> <!-- end #post -->

    <button id="js-fullscreen"><span id="icon-arrow" class="fontello"></span></button>

<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.pjax.js"></script>
<script src="/assets/js/nprogress.js"></script>
<script src="/assets/js/searchbox.js"></script>
<script src="/assets/js/script.js"></script>


    <script>
    //百度站点统计,排除localhost
    if(window.location.host.indexOf("localhost") ==-1 &&  window.location.host.indexOf("127.0.0.1") == -1){

        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?2c1583237ca3f5343d8dab0140019ca7";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    }
</script>
   </body>
 </html>