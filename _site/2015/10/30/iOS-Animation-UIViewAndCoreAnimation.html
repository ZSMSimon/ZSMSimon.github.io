<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="baidu-site-verification" content="w9Akh6dPe4" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<!--[if lte IE 8]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]-->

<title>iOS动画和特效（一）UIView动画和CoreAnimation | 曾绍明的博客</title>
<meta name="author" content="曾绍明">




<link rel="shortcut icon" href="" />

<link rel="stylesheet" type="text/css" href="/assets/css/style.css">

<link href="/pages/rss.xml" rel="alternate" title="曾绍明的博客" type="application/atom+xml">



  </head>
  <body>
        <aside id="sidebar">
  <nav id="tags">
    <a href="/index.html" id="avatar" style="background-image:url(https://avatars1.githubusercontent.com/u/15245912)"></a>

    <ul id="tags__ul">
      <li id="pl__all" class="tags__li tags-btn active">所有文章</li>
       
        <li id="技术" class="tags__li tags-btn">技术</li>
       
        <li id="web前端" class="tags__li tags-btn">web前端</li>
       
        <li id="专题" class="tags__li tags-btn">专题</li>
       
        <li id="iOS" class="tags__li tags-btn">iOS</li>
       
        <li id="生活" class="tags__li tags-btn">生活</li>
       
        <li id="react-native" class="tags__li tags-btn">react-native</li>
       
        <li id="其他" class="tags__li tags-btn">其他</li>
       
        <li id="IoT" class="tags__li tags-btn">IoT</li>
      
    </ul>

    <div id="tags__bottom">
      <a href="http://github.com/ZSMSimon" id="icon-github" class="tags-btn fontello" target="_blank"></a>
      <a href="/pages/rss.xml" id="icon-feed" class="tags-btn fontello" target="_blank"></a>
      <a href="mailto:ZSMSimon@163.com" id="icon-email" class="tags-btn fontello"></a>
    </div>
  </nav> <!-- end #tags -->

  <div id="posts-list">
    <form action="" id="search-form">
      <a href="/index.html" id="mobile-avatar" style="background-image:url(https://avatars1.githubusercontent.com/u/15245912)"></a>
      <!-- NOTE: input field is disabled by default -->
      <input id="search-input" type="text" placeholder="Search..." >
    </form>

    <nav id="pl__container">
    
      <a class="IoT pl__all" href="/2017/05/16/JavaScript-mqtt-temperaturedemo.html"><span class="pl__circle"></span><span class="pl__title">IoT技术选型及模型设计的思考</span><span class="pl__date">17/05/16</span></a>
    
      <a class="IoT pl__all" href="/2017/05/02/hello-nodemcu.html"><span class="pl__circle"></span><span class="pl__title">hello nodemcu</span><span class="pl__date">17/05/02</span></a>
    
      <a class="其他 pl__all" href="/2017/03/16/Recruitment.html"><span class="pl__circle"></span><span class="pl__title">阿里云iot事业部招聘信息</span><span class="pl__date">17/03/16</span></a>
    
      <a class="技术 pl__all" href="/2017/01/23/zhihu-live-a-hour-for-bluetooth-0.html"><span class="pl__circle"></span><span class="pl__title">知乎live：一小时蓝牙科普 文字整理版</span><span class="pl__date">17/01/23</span></a>
    
      <a class="web前端 pl__all" href="/2016/12/08/eslint-guide.html"><span class="pl__circle"></span><span class="pl__title">ESLint使用</span><span class="pl__date">16/12/08</span></a>
    
      <a class="其他 pl__all" href="/2016/12/06/how-to-fupan.html"><span class="pl__circle"></span><span class="pl__title">柳传志：我的复盘方法论</span><span class="pl__date">16/12/06</span></a>
    
      <a class="react-native pl__all" href="/2016/11/14/react-native-flux%E6%95%B0%E6%8D%AE%E6%B5%81.html"><span class="pl__circle"></span><span class="pl__title">flux数据流在rn中的使用</span><span class="pl__date">16/11/14</span></a>
    
      <a class="专题 pl__all" href="/2016/05/09/iOS-networking-0.html"><span class="pl__circle"></span><span class="pl__title">iOS 网络请求专题</span><span class="pl__date">16/05/09</span></a>
    
      <a class="iOS pl__all" href="/2016/04/03/iOS-JavaScriptCore.html"><span class="pl__circle"></span><span class="pl__title">iOS JavaScriptCore使用</span><span class="pl__date">16/04/03</span></a>
    
      <a class="iOS pl__all" href="/2016/04/02/iOS-3DTouch-3.html"><span class="pl__circle"></span><span class="pl__title">iOS 3D touch开发(三) Force Properties-按压力度</span><span class="pl__date">16/04/02</span></a>
    
      <a class="iOS pl__all" href="/2016/04/01/iOS-3DTouch-2.html"><span class="pl__circle"></span><span class="pl__title">iOS 3D touch开发(二) peek and pop - 预览和弹出</span><span class="pl__date">16/04/01</span></a>
    
      <a class="iOS pl__all" href="/2016/03/21/iOS-3DTouch-1.html"><span class="pl__circle"></span><span class="pl__title">iOS 3D touch开发(一) Home Screen Quick Actions</span><span class="pl__date">16/03/21</span></a>
    
      <a class="iOS pl__all" href="/2016/03/10/iOS-unit-test.html"><span class="pl__circle"></span><span class="pl__title">iOS单元测试</span><span class="pl__date">16/03/10</span></a>
    
      <a class="iOS pl__all" href="/2016/02/29/iOS-objc-styleguide.html"><span class="pl__circle"></span><span class="pl__title">iOS objc编程规范</span><span class="pl__date">16/02/29</span></a>
    
      <a class="iOS pl__all" href="/2016/02/13/ios-networking-5.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（五）网络请求中的cookie</span><span class="pl__date">16/02/13</span></a>
    
      <a class="iOS pl__all" href="/2016/02/09/ios-networking-4.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（四） http异步文件上传和下载以及进度指示</span><span class="pl__date">16/02/09</span></a>
    
      <a class="iOS pl__all" href="/2016/02/04/ios-networking-3.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（三） http异步请求和https认证</span><span class="pl__date">16/02/04</span></a>
    
      <a class="iOS pl__all" href="/2016/02/03/ios-networking-2.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（二） http异步队列请求</span><span class="pl__date">16/02/03</span></a>
    
      <a class="iOS pl__all" href="/2016/02/03/ios-networking-1.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（一） http同步请求</span><span class="pl__date">16/02/03</span></a>
    
      <a class="react-native pl__all" href="/2016/02/02/react-native-demo.html"><span class="pl__circle"></span><span class="pl__title">react-native（二） 自己写的react-native学习demo和整理的tips</span><span class="pl__date">16/02/02</span></a>
    
      <a class="react-native pl__all" href="/2016/01/11/react-native-helloworld.html"><span class="pl__circle"></span><span class="pl__title">react-native（一） hello world</span><span class="pl__date">16/01/11</span></a>
    
      <a class="iOS pl__all" href="/2016/01/06/iOS-app-versions.html"><span class="pl__circle"></span><span class="pl__title">api如何设计才能支撑多个不同版本的app共存</span><span class="pl__date">16/01/06</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/31/playwith-imageToAscii.html"><span class="pl__circle"></span><span class="pl__title">那些好玩的nodejs插件 - 把图片转为ascii</span><span class="pl__date">15/12/31</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/10/fe-componentization.html"><span class="pl__circle"></span><span class="pl__title">前端开发框架 - seajs+handlebars模块化开发</span><span class="pl__date">15/12/10</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/06/fe-nginx-usage.html"><span class="pl__circle"></span><span class="pl__title">mac环境nginx的安装和使用</span><span class="pl__date">15/12/06</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/03/fe-js-handlebars.html"><span class="pl__circle"></span><span class="pl__title">handlerbars的使用及模板预编译</span><span class="pl__date">15/12/03</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/01/fe-engineering-gulp.html"><span class="pl__circle"></span><span class="pl__title">gulp自动构建工具教程</span><span class="pl__date">15/12/01</span></a>
    
      <a class="web前端 pl__all" href="/2015/11/27/fe-environment.html"><span class="pl__circle"></span><span class="pl__title">前端开发工具和环境搭建</span><span class="pl__date">15/11/27</span></a>
    
      <a class="web前端 pl__all" href="/2015/11/26/rem-em-px.html"><span class="pl__circle"></span><span class="pl__title">css3属性rem的使用</span><span class="pl__date">15/11/26</span></a>
    
      <a class="生活 pl__all" href="/2015/11/26/mylift-github.html"><span class="pl__circle"></span><span class="pl__title">我每天都在github上做些什么</span><span class="pl__date">15/11/26</span></a>
    
      <a class="iOS pl__all" href="/2015/11/24/iOS-affine-transfermation-animation.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（七）仿射变换-CGAffineTransform</span><span class="pl__date">15/11/24</span></a>
    
      <a class="iOS pl__all" href="/2015/11/22/iOS-library-spring.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（六）swift动画库spring使用和代码拆解</span><span class="pl__date">15/11/22</span></a>
    
      <a class="iOS pl__all" href="/2015/11/16/iOS-Implicit-Animation.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（五）layer隐式动画</span><span class="pl__date">15/11/16</span></a>
    
      <a class="iOS pl__all" href="/2015/11/06/iOS-controller-transitioning.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（四）controller间的自定义过渡效果</span><span class="pl__date">15/11/06</span></a>
    
      <a class="iOS pl__all" href="/2015/11/01/iOS-MotionEffects.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（三）MotionEffects</span><span class="pl__date">15/11/01</span></a>
    
      <a class="iOS pl__all" href="/2015/10/30/iOS-UIKit-Dynamics.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（二）UIKit力学行为</span><span class="pl__date">15/10/30</span></a>
    
      <a class="iOS pl__all" href="/2015/10/30/iOS-Animation-UIViewAndCoreAnimation.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（一）UIView动画和CoreAnimation</span><span class="pl__date">15/10/30</span></a>
    
      <a class="专题 pl__all" href="/2015/10/29/iOS-animation-0.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效专题（零）- 大纲和计划</span><span class="pl__date">15/10/29</span></a>
    
      <a class="iOS pl__all" href="/2015/10/17/ios-webView.html"><span class="pl__circle"></span><span class="pl__title">UIWebView和WKWebView的使用及js交互</span><span class="pl__date">15/10/17</span></a>
    
      <a class="iOS pl__all" href="/2015/10/06/ios-swift-quick.html"><span class="pl__circle"></span><span class="pl__title">swift5分钟语法速记</span><span class="pl__date">15/10/06</span></a>
    
      <a class="iOS pl__all" href="/2015/09/20/ios-macro.html"><span class="pl__circle"></span><span class="pl__title">ios宏的使用和技巧</span><span class="pl__date">15/09/20</span></a>
    
      <a class="iOS pl__all" href="/2015/09/11/ios-BLE-4.html"><span class="pl__circle"></span><span class="pl__title">ios蓝牙开发（四）BabyBluetooth蓝牙库介绍</span><span class="pl__date">15/09/11</span></a>
    
      <a class="iOS pl__all" href="/2015/09/07/ios-BLE-3.html"><span class="pl__circle"></span><span class="pl__title">ios蓝牙开发（三）app作为外设被连接的实现</span><span class="pl__date">15/09/07</span></a>
    
      <a class="iOS pl__all" href="/2015/09/02/ios-draw-Graffiti-2.html"><span class="pl__circle"></span><span class="pl__title">ios绘图demo,做一个涂鸦板(下)</span><span class="pl__date">15/09/02</span></a>
    
      <a class="web前端 pl__all" href="/2015/08/29/go-deep-into-unsilder.js.html"><span class="pl__circle"></span><span class="pl__title">深入理解unslider.js源码</span><span class="pl__date">15/08/29</span></a>
    
      <a class="生活 pl__all" href="/2015/08/23/life-keyboardAndHHKB.html"><span class="pl__circle"></span><span class="pl__title">键盘那些事，hhkb开箱</span><span class="pl__date">15/08/23</span></a>
    
      <a class="技术 pl__all" href="/2015/08/22/github-ImagesUploadWebSite.html"><span class="pl__circle"></span><span class="pl__title">自己markdown博客的图床程序</span><span class="pl__date">15/08/22</span></a>
    
      <a class="iOS pl__all" href="/2015/08/19/ios-ThreadAndAsynchronization.html"><span class="pl__circle"></span><span class="pl__title">ios的线程和同步异步操作</span><span class="pl__date">15/08/19</span></a>
    
      <a class="iOS pl__all" href="/2015/08/14/ios-BLE-2.html"><span class="pl__circle"></span><span class="pl__title">ios蓝牙开发（二）ios连接外设的代码实现</span><span class="pl__date">15/08/14</span></a>
    
      <a class="iOS pl__all" href="/2015/07/26/ios-draw-Graffiti.html"><span class="pl__circle"></span><span class="pl__title">ios绘图demo,做一个涂鸦板(上)</span><span class="pl__date">15/07/26</span></a>
    
      <a class="iOS pl__all" href="/2015/07/25/ios-draw-base.html"><span class="pl__circle"></span><span class="pl__title">ios绘图基础</span><span class="pl__date">15/07/25</span></a>
    
      <a class="iOS pl__all" href="/2015/07/17/ios-BLE-1.html"><span class="pl__circle"></span><span class="pl__title">iOS蓝牙开发（一）蓝牙相关基础知识</span><span class="pl__date">15/07/17</span></a>
    
      <a class="专题 pl__all" href="/2015/07/17/ios-BLE-0.html"><span class="pl__circle"></span><span class="pl__title">iOS蓝牙的开发专题</span><span class="pl__date">15/07/17</span></a>
    
      <a class="技术 pl__all" href="/2015/07/07/mybatis.html"><span class="pl__circle"></span><span class="pl__title">MyBatis简单使用的demo</span><span class="pl__date">15/07/07</span></a>
    
      <a class="技术 pl__all" href="/2015/07/06/rabbitmq.html"><span class="pl__circle"></span><span class="pl__title">RabbitMQ使用</span><span class="pl__date">15/07/06</span></a>
    
      <a class="iOS pl__all" href="/2015/06/14/ios-library-masonry.html"><span class="pl__circle"></span><span class="pl__title">Masonry的使用</span><span class="pl__date">15/06/14</span></a>
    
      <a class="专题 pl__all" href="/2015/06/14/ios-library-0.html"><span class="pl__circle"></span><span class="pl__title">iOS中那些好用的第三方库</span><span class="pl__date">15/06/14</span></a>
    
      <a class="iOS pl__all" href="/2015/05/29/ios-develop-tool.html"><span class="pl__circle"></span><span class="pl__title">提高iOS开发效率的工具</span><span class="pl__date">15/05/29</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-4.html"><span class="pl__circle"></span><span class="pl__title">Spring 文件上传</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-3.html"><span class="pl__circle"></span><span class="pl__title">Spring- Hibernate数据基本操作</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-2.html"><span class="pl__circle"></span><span class="pl__title">Spring RestController 请求参数详解</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-1.html"><span class="pl__circle"></span><span class="pl__title">Spring和hibernate的maven配置</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/tomcat-domain-name.html"><span class="pl__circle"></span><span class="pl__title">tomcat部署绑定多个域名</span><span class="pl__date">15/05/28</span></a>
    
      <a class="专题 pl__all" href="/2015/05/28/spring-0.html"><span class="pl__circle"></span><span class="pl__title">Spring4+hibernate专题</span><span class="pl__date">15/05/28</span></a>
    
      <a class="web前端 pl__all" href="/2015/04/29/css-selector.html"><span class="pl__circle"></span><span class="pl__title">css选择器的用法</span><span class="pl__date">15/04/29</span></a>
    
      <a class="技术 pl__all" href="/2014/02/12/how-to-deploy-a-blog-on-github-by-jekyll.html"><span class="pl__circle"></span><span class="pl__title">在Github上搭建Jekyll博客和创建主题</span><span class="pl__date">14/02/12</span></a>
    
      <a class="技术 pl__all" href="/2013/04/23/opensource-licenses.html"><span class="pl__circle"></span><span class="pl__title">五中常见的开源协议整理(BSD,Apache,GPL,LGPL,MIT)</span><span class="pl__date">13/04/23</span></a>
    
    </nav>
  </div> <!-- end #posts-list -->
</aside> <!-- end #sidebar -->
    <div id="post">
      <div id="pjax">
        <article id="post__content">
    <h1 id="post__title" data-identifier="20151030">iOS动画和特效（一）UIView动画和CoreAnimation</h1>
    <h2 id="一个简单的例子作为ios动画系类的开始-quickexampleviewcontroller">一个简单的例子作为iOS动画系类的开始 QuickExampleViewController</h2>
<hr />
<blockquote>
  <p>UIView的方法中有几个易用的静态方法可以做出动画效果，分别是UIView.beginAnimations() -&gt;  UIView.commitAnimations() 和UIView.animateWithDuration()方法
  我们以一个UIView，每点击一次向右移动100，变色，加速运动这个简单的动效作为例子。
  转载请注明出处</p>
</blockquote>

<p>使用UIView.beginAnimations() -&gt;  UIView.commitAnimations()实现</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
        <span class="c1">//开始动画配置</span>
        <span class="kt">UIView</span><span class="o">.</span><span class="nf">beginAnimations</span><span class="p">(</span><span class="s">"view1Animation"</span><span class="p">,</span> <span class="nv">context</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="c1">//运动时间</span>
        <span class="kt">UIView</span><span class="o">.</span><span class="nf">setAnimationDuration</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="c1">//设置运动开始和结束的委托 animationDidStart and animationDidStop</span>
        <span class="kt">UIView</span><span class="o">.</span><span class="nf">setAnimationDelegate</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>
        <span class="cm">/*
            缓动方式
            EaseInOut // slow at beginning and end
            EaseIn // slow at beginning
            EaseOut // slow at end
            Linear
        */</span>
        <span class="kt">UIView</span><span class="o">.</span><span class="nf">setAnimationCurve</span><span class="p">(</span><span class="o">.</span><span class="kt">EaseIn</span><span class="p">)</span>
        <span class="c1">//位置运动</span>
        <span class="n">theView</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="mi">100</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="c1">//颜色渐变</span>
        <span class="n">theView</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="nf">greenColor</span><span class="p">()</span>
        <span class="c1">//透明度渐变</span>
        <span class="n">theView</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="c1">//动画开始</span>
        <span class="kt">UIView</span><span class="o">.</span><span class="nf">commitAnimations</span><span class="p">()</span>

</code></pre></div></div>

<p>使用更简单的和UIView.animateWithDuration()实现</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="kt">UIView</span><span class="o">.</span><span class="nf">animateWithDuration</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="nv">delay</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="kt">UIViewAnimationOptions</span><span class="o">.</span><span class="kt">CurveEaseIn</span><span class="p">,</span> <span class="nv">animations</span><span class="p">:</span> <span class="p">{</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
                <span class="c1">//位置运动</span>
                <span class="n">theView</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="mi">100</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
                <span class="c1">//颜色渐变</span>
                <span class="n">theView</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="kt">UIColor</span><span class="o">.</span><span class="nf">greenColor</span><span class="p">()</span>
                <span class="c1">//透明度渐变</span>
                <span class="n">theView</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="p">})</span> <span class="p">{</span> <span class="p">(</span><span class="n">isCompletion</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
                <span class="kt">NSLog</span><span class="p">(</span><span class="s">"completion"</span><span class="p">)</span>
        <span class="p">}</span>

</code></pre></div></div>

<p>animateWithDuration的方法有4个从载方法，参数不同，根据需要调用。其中最后一个代理一个阻尼系数和回弹系数，使用他可以做出更加逼真的运动效果</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     <span class="c1">//usingSpringWithDamping 阻尼，范围0-1，阻尼越接近于0，弹性效果越明显</span>
     <span class="kt">UIView</span><span class="o">.</span><span class="nf">animateWithDuration</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="nv">delay</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">usingSpringWithDamping</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span> <span class="nv">initialSpringVelocity</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="kt">UIViewAnimationOptions</span><span class="o">.</span><span class="kt">CurveEaseIn</span><span class="p">,</span> <span class="nv">animations</span><span class="p">:</span> <span class="p">{</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
         <span class="n">theView</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="mi">100</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="p">},</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre></div></div>

<p>本节介绍的几个方法，已经可以做出许多的简单动画效果了，这说明apple对高级别对象的动画api封装做的很不错。代码见QuickExampleViewController.swift</p>

<h2 id="core-animation的类图">Core Animation的类图</h2>
<hr />

<p><img src="http://localhost:4000/assets/uploads/animationAndEffect05.png" alt="" /></p>

<p>CAAnimation：核心动画的基础类，不能直接使用，负责动画运行时间、速度的控制，本身实现了CAMediaTiming协议。</p>

<p>CAPropertyAnimation：属性动画的基类（通过属性进行动画设置，注意是可动画属性），不能直接使用。</p>

<p>CAAnimationGroup：动画组，动画组是一种组合模式设计，可以通过动画组来进行所有动画行为的统一控制，组中所有动画效果可以并发执行。</p>

<p>CATransition：转场动画，主要通过滤镜进行动画效果设置。</p>

<p>CABasicAnimation：基础动画，通过属性修改进行动画参数控制，只有初始状态和结束状态。</p>

<p>CAKeyframeAnimation：关键帧动画，同样是通过属性进行动画参数控制，但是同基础动画不同的是它可以有多个状态控制。</p>

<h2 id="基本动画-cabasicanimation">基本动画 CABasicAnimation</h2>
<hr />
<blockquote>
  <p>还记得上一节简单的动画吗，一个uiview向左平移100，这节我们使用CABasicAnimation实现相同的效果</p>
</blockquote>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
            <span class="k">let</span> <span class="nv">baseAnimation</span> <span class="o">=</span> <span class="kt">CABasicAnimation</span><span class="p">(</span><span class="nv">keyPath</span><span class="p">:</span> <span class="s">"position"</span><span class="p">)</span>
            <span class="c1">//baseAnimation.fromValue 初始位置，如果不设就是当前位置</span>
<span class="c1">//          let point = CGPoint(x: theView.layer.position.x+100, y: theView.layer.position.y)</span>
<span class="c1">//          baseA baseAnimation.toValue = NSValue(CGPoint:point)nimation.toValue = NSValue(CGPoint:point)//绝对位置</span>
            <span class="n">baseAnimation</span><span class="o">.</span><span class="n">byValue</span> <span class="o">=</span> <span class="kt">NSValue</span><span class="p">(</span><span class="kt">CGPoint</span><span class="p">:</span><span class="kt">CGPoint</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mi">0</span><span class="p">))</span><span class="c1">//相对位置</span>

            <span class="c1">//动画其他属性</span>
            <span class="n">baseAnimation</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">0.2</span>
            <span class="n">baseAnimation</span><span class="o">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">baseAnimation</span><span class="o">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="kt">CAMediaTimingFunction</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="n">kCAMediaTimingFunctionEaseIn</span><span class="p">)</span><span class="c1">//加速运动</span>
            <span class="c1">//baseAnimation.timingFunction = CAMediaTimingFunction(controlPoints: 0.5, 0, 0.9, 0.7)//自定义加速的曲线参数</span>

            <span class="c1">//这两个属性若不设置，动画执行后回复位</span>
            <span class="n">baseAnimation</span><span class="o">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="kc">false</span>
            <span class="n">baseAnimation</span><span class="o">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeForwards</span>

            <span class="c1">//可以在动画中缓存一些</span>
            <span class="c1">//baseAnimation.setValue(NSValue(CGPoint: point), forKey: "startPoint")</span>
            <span class="c1">//开始动画</span>
            <span class="n">theView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">baseAnimation</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"theViewMoveRight100"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="cabasicanimation注意点">CABasicAnimation注意点</h3>

<p>使用上面的代码之后，发现点击之后view确实向右移动了100，但是再次点击红色区域却发现不会继续移动了，但是点击移动前view所在位置,红色区域会重复移动，如图
<img src="http://localhost:4000/assets/uploads/animationAndEffect01.gif" alt="" /></p>

<p>出现这种现象的原因是因为动画是通过view的layer设置位置的。而设置layer的位置后，uiview的位置是不会发生变化的，所以虽然看见红色移动了，但其实红色view.frame没变化，所以点击区域也没变化。那么如何解决？</p>

<p>解决的思路是在每次动画结束后，把view.frame的位置重新设置成移动后的位置。代码如下：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//步骤1，设置动画的委托</span>
 <span class="n">baseAnimation</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>

<span class="c1">//步骤2：将移动后的点和要移动的view放入baseAnimation的context</span>
<span class="n">baseAnimation</span><span class="o">.</span><span class="nf">setValue</span><span class="p">(</span><span class="kt">NSValue</span><span class="p">(</span><span class="kt">CGPoint</span><span class="p">:</span> <span class="n">endPoint</span><span class="p">),</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"endPoint"</span><span class="p">)</span>
<span class="n">baseAnimation</span><span class="o">.</span><span class="nf">setValue</span><span class="p">(</span><span class="n">theView</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"sender"</span><span class="p">)</span>

<span class="c1">//步骤3：重写animationDidStop，layer.position</span>
<span class="k">override</span> <span class="kd">func</span> <span class="nf">animationDidStop</span><span class="p">(</span><span class="nv">anim</span><span class="p">:</span><span class="kt">CAAnimation</span><span class="p">,</span> <span class="n">finished</span> <span class="nv">flag</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">endPoint</span> <span class="o">=</span> <span class="n">anim</span><span class="o">.</span><span class="nf">valueForKey</span><span class="p">(</span><span class="s">"endPoint"</span><span class="p">)?</span><span class="o">.</span><span class="kt">CGPointValue</span>
    <span class="k">let</span> <span class="nv">theView</span> <span class="o">=</span> <span class="n">anim</span><span class="o">.</span><span class="nf">valueForKey</span><span class="p">(</span><span class="s">"sender"</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">UIView</span>
    <span class="n">theView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">endPoint</span><span class="o">!</span>
<span class="p">}</span>

</code></pre></div></div>

<p>其他注意几个地方</p>

<p>1:keyPath用于区分BasicAnimation动画类型</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="cm">/*
        可选的KeyPath
        transform.scale = 比例轉換
        transform.scale.x
        transform.scale.y
        transform.rotation = 旋轉
        transform.rotation.x
        transform.rotation.y
        transform.rotation.z
        transform.translation
        transform.translation.x
        transform.translation.y
        transform.translation.z

        opacity = 透明度
        margin
        zPosition
        backgroundColor 背景颜色
        cornerRadius 圆角
        borderWidth
        bounds
        contents
        contentsRect
        cornerRadius
        frame
        hidden
        mask
        masksToBounds
        opacity
        position
        shadowColor
        shadowOffset
        shadowOpacity
        shadowRadius

    */</span>
</code></pre></div></div>

<p>2:动画执行后不恢复原位</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//这两个属性若不设置，动画执行后回复位</span>
<span class="n">baseAnimation</span><span class="o">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">baseAnimation</span><span class="o">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeForwards</span>
</code></pre></div></div>

<h3 id="cabasicanimation-组合动画">CABasicAnimation 组合动画</h3>
<blockquote>
  <p>组合动画就是把一组CABasicAnimation组合使用，我们以组合移动、旋转、缩放特效为例</p>
</blockquote>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="c1">//组合动画</span>
    <span class="kd">func</span> <span class="nf">groupAnimation</span><span class="p">(</span><span class="nv">theView</span><span class="p">:</span><span class="kt">UIView</span><span class="p">){</span>

        <span class="c1">//向右平移100</span>
        <span class="k">let</span> <span class="nv">mAnimation</span> <span class="o">=</span> <span class="kt">CABasicAnimation</span><span class="p">(</span><span class="nv">keyPath</span><span class="p">:</span> <span class="s">"position"</span><span class="p">)</span>
        <span class="c1">//baseAnimation.fromValue 初始位置，如果不设就是当前位置</span>
        <span class="k">let</span> <span class="nv">endPoint</span> <span class="o">=</span> <span class="kt">CGPoint</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="mi">100</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="n">theView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="n">mAnimation</span><span class="o">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="kt">NSValue</span><span class="p">(</span><span class="kt">CGPoint</span><span class="p">:</span><span class="n">endPoint</span><span class="p">)</span><span class="c1">//绝对位置</span>

        <span class="c1">//baseAnimation.byValue = NSValue(CGPoint:CGPoint(x: 100, y: 0))//相对位置</span>

        <span class="c1">//x轴旋转动画</span>
        <span class="k">let</span> <span class="nv">xAnimation</span> <span class="o">=</span> <span class="kt">CABasicAnimation</span><span class="p">(</span><span class="nv">keyPath</span><span class="p">:</span> <span class="s">"transform.rotation.x"</span><span class="p">)</span>
        <span class="p">(</span><span class="n">xAnimation</span> <span class="k">as</span> <span class="kt">CABasicAnimation</span><span class="p">)</span><span class="o">.</span><span class="n">byValue</span> <span class="o">=</span>  <span class="kt">NSNumber</span><span class="p">(</span><span class="nv">double</span><span class="p">:</span><span class="kt">M_PI</span><span class="o">*</span><span class="mi">500</span><span class="p">)</span>
        <span class="n">xAnimation</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">1.5</span>

        <span class="c1">//y轴旋转动画</span>
        <span class="k">let</span> <span class="nv">yAnimation</span> <span class="o">=</span> <span class="kt">CABasicAnimation</span><span class="p">(</span><span class="nv">keyPath</span><span class="p">:</span> <span class="s">"transform.rotation.y"</span><span class="p">)</span>
        <span class="p">(</span><span class="n">yAnimation</span> <span class="k">as</span> <span class="kt">CABasicAnimation</span><span class="p">)</span><span class="o">.</span><span class="n">byValue</span> <span class="o">=</span>  <span class="kt">NSNumber</span><span class="p">(</span><span class="nv">double</span><span class="p">:</span><span class="kt">M_PI</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span>

        <span class="c1">//缩放动画</span>
        <span class="k">let</span> <span class="nv">sAnimation</span> <span class="o">=</span> <span class="kt">CABasicAnimation</span><span class="p">(</span><span class="nv">keyPath</span><span class="p">:</span> <span class="s">"transform.scale"</span><span class="p">)</span>
        <span class="c1">// 动画选项设定</span>
        <span class="n">sAnimation</span><span class="o">.</span><span class="n">autoreverses</span> <span class="o">=</span> <span class="kc">true</span> <span class="c1">// 动画结束时执行逆动画</span>
        <span class="c1">// 缩放倍数</span>
        <span class="n">sAnimation</span><span class="o">.</span><span class="n">fromValue</span> <span class="o">=</span> <span class="kt">NSNumber</span><span class="p">(</span><span class="nv">double</span><span class="p">:</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1">// 开始时的倍率</span>
        <span class="n">sAnimation</span><span class="o">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="kt">NSNumber</span><span class="p">(</span><span class="nv">double</span><span class="p">:</span><span class="mf">1.5</span><span class="p">)</span> <span class="c1">// 结束时的倍率</span>

        <span class="c1">//动画组</span>
        <span class="k">let</span> <span class="nv">groupAnimation</span> <span class="o">=</span> <span class="kt">CAAnimationGroup</span><span class="p">()</span>

        <span class="c1">// 动画选项设定，动画组统一设置或者单独设置</span>
        <span class="n">groupAnimation</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">;</span>
        <span class="n">groupAnimation</span><span class="o">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">groupAnimation</span><span class="o">.</span><span class="n">animations</span> <span class="o">=</span> <span class="p">[</span><span class="n">xAnimation</span><span class="p">,</span><span class="n">yAnimation</span><span class="p">,</span><span class="n">sAnimation</span><span class="p">,</span><span class="n">mAnimation</span><span class="p">]</span>
        <span class="c1">//这两个属性若不设置，动画执行后回复位</span>
        <span class="n">groupAnimation</span><span class="o">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="n">groupAnimation</span><span class="o">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeForwards</span>
        <span class="n">groupAnimation</span><span class="o">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="kt">CAMediaTimingFunction</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="n">kCAMediaTimingFunctionEaseIn</span><span class="p">)</span><span class="c1">//加速运动</span>
        <span class="n">groupAnimation</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
        <span class="c1">//可以在动画中缓存一些</span>
        <span class="n">groupAnimation</span><span class="o">.</span><span class="nf">setValue</span><span class="p">(</span><span class="kt">NSValue</span><span class="p">(</span><span class="kt">CGPoint</span><span class="p">:</span> <span class="n">endPoint</span><span class="p">),</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"endPoint"</span><span class="p">)</span>
        <span class="n">groupAnimation</span><span class="o">.</span><span class="nf">setValue</span><span class="p">(</span><span class="n">theView</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"sender"</span><span class="p">)</span>
        <span class="c1">//执行动画</span>
        <span class="n">theView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">groupAnimation</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"theViewMoveRotation90"</span><span class="p">)</span>
    <span class="p">}</span>

</code></pre></div></div>

<p><img src="http://localhost:4000/assets/uploads/animationAndEffect02.gif" alt="" /></p>

<h2 id="关键帧动画-cakeyframeanimation">关键帧动画 CAKeyframeAnimation</h2>
<blockquote>
  <p>关键帧动画就是在动画控制过程中开发者指定主要的动画状态，至于各个状态间动画如何进行则由系统自动运算补充（每两个关键帧之间系统形成的动画称为“补间动画”），这种动画的好处就是开发者不用逐个控制每个动画帧，而只要关心几个关键帧的状态即可。</p>
</blockquote>

<p>关键帧动画和基本动画也很相似，通过keyPath设置动画类型，才对齐进行一组关键值的设定。数据变化也有2种形式，一种是关键点，一种是路径，比如实例中的按一个贝塞尔弧移动view。</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
        <span class="c1">//关键帧动画</span>
        <span class="c1">//keyPath和basicAnimation的类型相同，@see BasicAnimationViewController.swift</span>
        <span class="k">let</span> <span class="nv">keyframeAnimation</span> <span class="o">=</span> <span class="kt">CAKeyframeAnimation</span><span class="p">(</span><span class="nv">keyPath</span><span class="p">:</span> <span class="s">"position"</span><span class="p">)</span>

        <span class="c1">//线段的位置移动</span>
<span class="c1">//        keyframeAnimation.values = [</span>
<span class="c1">//                                        NSValue(CGPoint: CGPoint(x: 10, y: 100)),</span>
<span class="c1">//                                        NSValue(CGPoint: CGPoint(x: 30, y: 100)),</span>
<span class="c1">//                                        NSValue(CGPoint: CGPoint(x: 30, y: 120)),</span>
<span class="c1">//                                        NSValue(CGPoint: CGPoint(x: 60, y: 120)),</span>
<span class="c1">//                                        NSValue(CGPoint: CGPoint(x: 60, y: 100)),</span>
<span class="c1">//                                        NSValue(CGPoint: CGPoint(x: 106, y: 210)),</span>
<span class="c1">//                                        NSValue(CGPoint: CGPoint(x: 106, y: 410)),</span>
<span class="c1">//                                        NSValue(CGPoint: CGPoint(x: 300, y: 310))</span>
<span class="c1">//                                   ]</span>

        <span class="c1">//弧线位置移动</span>
        <span class="k">let</span> <span class="nv">path</span> <span class="o">=</span> <span class="kt">CGPathCreateMutable</span><span class="p">()</span>
        <span class="kt">CGPathMoveToPoint</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="kt">CGPathAddCurveToPoint</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">keyframeAnimation</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>

        <span class="c1">//设置其他属性</span>
        <span class="n">keyframeAnimation</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="c1">//        keyframeAnimation.beginTime = CACurrentMediaTime() + 2;//设置延迟2秒执行</span>

        <span class="n">tapGesture</span><span class="o">.</span><span class="n">view</span><span class="p">?</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">keyframeAnimation</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"keyframeAnimation1"</span><span class="p">)</span>

</code></pre></div></div>

<p><img src="http://localhost:4000/assets/uploads/animationAndEffect03.gif" alt="" /></p>

<p>关键帧动画其他可以设置的参数</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">//keyTimes：各个关键帧的时间控制</span>

<span class="c1">//caculationMode：动画计算模式。</span>
<span class="nv">kCAAnimationLinear</span><span class="p">:</span> <span class="n">线性模式</span><span class="err">，</span><span class="n">默认值</span>
<span class="nv">kCAAnimationDiscrete</span><span class="p">:</span> <span class="n">离散模式</span>
<span class="nv">kCAAnimationPaced</span><span class="p">:</span><span class="n">均匀处理</span><span class="err">，</span><span class="n">会忽略keyTimes</span>
<span class="nv">kCAAnimationCubic</span><span class="p">:</span><span class="n">平滑执行</span><span class="err">，</span><span class="n">对于位置变动关键帧动画运行轨迹更平滑</span>
<span class="nv">kCAAnimationCubicPaced</span><span class="p">:</span><span class="n">平滑均匀执行</span>

</code></pre></div></div>

<h2 id="转场效果">转场效果</h2>

<p>转场动画就是从一个场景以动画的形式过渡到另一个场景。转场动画的使用一般分为以下几个步骤：</p>

<ul>
  <li>创建转场动画</li>
  <li>设置转场类型、子类型（可选）及其他属性</li>
  <li>设置转场后的新视图并添加动画到图层</li>
</ul>

<p>一个简单专场效果的例子：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
        <span class="k">let</span> <span class="nv">transfer</span> <span class="o">=</span> <span class="kt">CATransition</span><span class="p">()</span>
        <span class="n">transfer</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">kCATransitionPush</span><span class="c1">//push过渡方式</span>
        <span class="n">transfer</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">imageView</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="nf">fetchImage</span><span class="p">()</span> <span class="c1">//获取新的UIImage对象</span>
        <span class="n">imageView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="nf">swipeTransition</span><span class="p">(),</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"rightSwipe"</span><span class="p">)</span><span class="c1">//开始转场</span>

</code></pre></div></div>

<p>转场的效果transfer.type有很多选项，主要选项有</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kCATransitionFade：淡入淡出，默认效果
kCATransitionMoveIn：新视图移动到就是图上方
kCATransitionPush:新视图推开旧视图
kCATransitionReveal：移走旧视图然后显示新视图

//苹果未公开的私有转场效果
cube:立方体
suckEffect:吸走的效果
oglFlip:前后翻转效果
rippleEffect:波纹效果
pageCurl:翻页起来
pageUnCurl:翻页下来
cameraIrisHollowOpen:镜头开
cameraIrisHollowClose:镜头关
</code></pre></div></div>

<p>除了淡入淡出以外，其余三个效果都存在方向性，所以还有个.subType可以设置方向类型</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kCATransitionFromRight:
kCATransitionFromLeft:
kCATransitionFromTop:
kCATransitionFromBottom:
</code></pre></div></div>

<p>下面我们来实现一个淡入淡出切换图片的场景。</p>
<ul>
  <li>左右滑动切换图片</li>
  <li>切换的图片和切换效果随机出现</li>
</ul>

<p><em>步骤1：添加view底图，添加view的左右滑动手势</em></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="c1">//背景图片</span>
        <span class="k">let</span> <span class="nv">bg</span> <span class="o">=</span> <span class="kt">UIImageView</span><span class="p">(</span><span class="nv">image</span><span class="p">:</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span> <span class="s">"x1.png"</span><span class="p">))</span>
        <span class="n">bg</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">frame</span>
        <span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">bg</span><span class="p">)</span>

        <span class="c1">//左右滑动事件</span>
        <span class="k">let</span> <span class="nv">rigthSwipe</span> <span class="o">=</span> <span class="kt">UISwipeGestureRecognizer</span><span class="p">(</span><span class="nv">target</span><span class="p">:</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span><span class="s">"rightSwipe:"</span><span class="p">)</span>
        <span class="n">rigthSwipe</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="o">.</span><span class="kt">Right</span>
        <span class="k">let</span> <span class="nv">leftSwipe</span> <span class="o">=</span> <span class="kt">UISwipeGestureRecognizer</span><span class="p">(</span><span class="nv">target</span><span class="p">:</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span><span class="s">"leftSwipe:"</span><span class="p">)</span>
        <span class="n">leftSwipe</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="o">.</span><span class="kt">Left</span>
        <span class="n">view</span><span class="o">.</span><span class="nf">addGestureRecognizer</span><span class="p">(</span><span class="n">rigthSwipe</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="nf">addGestureRecognizer</span><span class="p">(</span><span class="n">leftSwipe</span><span class="p">)</span>

    <span class="p">}</span>

</code></pre></div></div>

<p><em>步骤2：随机获取图片和随机获取转场效果的函数</em></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="kd">func</span> <span class="nf">fetchImage</span><span class="p">()</span><span class="o">-&gt;</span><span class="kt">UIImage</span><span class="p">{</span>
        <span class="k">if</span> <span class="n">images</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">{</span>
            <span class="n">images</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">for</span> <span class="n">index</span> <span class="k">in</span> <span class="mi">0</span><span class="o">...</span><span class="mi">5</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">image</span> <span class="o">=</span> <span class="kt">UIImage</span><span class="p">(</span><span class="nv">named</span><span class="p">:</span> <span class="s">"x"</span> <span class="o">+</span> <span class="kt">String</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
                <span class="n">images</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">image</span><span class="o">!</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">images</span><span class="p">[</span><span class="kt">Int</span><span class="p">(</span><span class="nf">arc4random</span><span class="p">()</span><span class="o">%</span><span class="mi">5</span><span class="p">)]</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">swipeTransition</span><span class="p">(</span><span class="nv">subtype</span><span class="p">:</span><span class="kt">String</span><span class="p">)</span><span class="o">-&gt;</span><span class="kt">CATransition</span><span class="p">{</span>
        <span class="k">let</span> <span class="nv">transfer</span> <span class="o">=</span> <span class="kt">CATransition</span><span class="p">()</span>
        <span class="cm">/*
            kCATransitionFade：淡入淡出，默认效果
            kCATransitionMoveIn：新视图移动到就是图上方
            kCATransitionPush:新视图推开旧视图
            kCATransitionReveal：移走旧视图然后显示新视图

            //苹果未公开的私有转场效果
            cube:立方体
            suckEffect:吸走的效果
            oglFlip:前后翻转效果
            rippleEffect:波纹效果
            pageCurl:翻页起来
            pageUnCurl:翻页下来
            cameraIrisHollowOpen:镜头开
            cameraIrisHollowClose:镜头关
        */</span>
        <span class="k">let</span> <span class="nv">types</span> <span class="o">=</span> <span class="p">[</span><span class="n">kCATransitionFade</span><span class="p">,</span><span class="n">kCATransitionMoveIn</span><span class="p">,</span><span class="n">kCATransitionPush</span><span class="p">,</span><span class="n">kCATransitionReveal</span><span class="p">,</span><span class="s">"cube"</span><span class="p">,</span><span class="s">"suckEffect"</span><span class="p">,</span><span class="s">"oglFlip"</span><span class="p">,</span><span class="s">"rippleEffect"</span><span class="p">,</span><span class="s">"pageCurl"</span><span class="p">,</span><span class="s">"pageUnCurl"</span><span class="p">,</span><span class="s">"cameraIrisHollowOpen"</span><span class="p">,</span><span class="s">"cameraIrisHollowClose"</span><span class="p">]</span>
        <span class="k">let</span> <span class="nv">type</span> <span class="o">=</span> <span class="n">types</span><span class="p">[</span><span class="kt">Int</span><span class="p">(</span><span class="nf">arc4random</span><span class="p">()</span><span class="o">%</span><span class="mi">11</span><span class="p">)]</span>
        <span class="n">transfer</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">type</span>
        <span class="kt">NSLog</span><span class="p">(</span><span class="s">"%@"</span><span class="p">,</span> <span class="n">type</span><span class="p">)</span>
        <span class="n">transfer</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">subtype</span>
        <span class="n">transfer</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">transfer</span>
    <span class="p">}</span>


</code></pre></div></div>

<p><em>步骤3：左右滑动方法，实现场景切换</em></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
      <span class="kd">func</span> <span class="nf">rightSwipe</span><span class="p">(</span><span class="nv">gesture</span><span class="p">:</span><span class="kt">UISwipeGestureRecognizer</span><span class="p">){</span>
          <span class="n">bg</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="nf">fetchImage</span><span class="p">()</span>
          <span class="n">bg</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="nf">swipeTransition</span><span class="p">(</span><span class="n">kCATransitionFromRight</span><span class="p">),</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"rightSwipe"</span><span class="p">)</span>

      <span class="p">}</span>

      <span class="kd">func</span> <span class="nf">leftSwipe</span><span class="p">(</span><span class="nv">gesture</span><span class="p">:</span><span class="kt">UISwipeGestureRecognizer</span><span class="p">){</span>
          <span class="n">bg</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="nf">fetchImage</span><span class="p">()</span>
          <span class="n">bg</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="nf">swipeTransition</span><span class="p">(</span><span class="n">kCATransitionFromLeft</span><span class="p">),</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"leftSwipe"</span><span class="p">)</span>
      <span class="p">}</span>

</code></pre></div></div>

<p>完成后效果图如下：
<img src="http://localhost:4000/assets/uploads/animationAndEffect04.gif" alt="" /></p>

<h2 id="demo">demo</h2>
<hr />
<p><a href="https://github.com/coolnameismy/demo/tree/master/AnimationAndEffects">本文的demo下载</a></p>

<p>本文的代码对于的文件名：</p>

<ul>
  <li>QuickExampleViewController.swift</li>
  <li>BasicAnimationViewController.swift</li>
  <li>KeyFrameAnimationViewController.swift</li>
  <li>TransferAnimationViewController.swift</li>
</ul>

<p>感谢收看，如果对大家有帮助，请<a href="https://github.com/coolnameismy">github上follow和star</a>，本文发布在<a href="https://zsmsimon.github.io/">刘彦玮的技术博客</a>，转载请注明出处</p>

<h2 id="参考文章">参考文章</h2>
<hr />

<ul>
  <li><a href="/2015/10/29/iOS-animation-0.html">iOS动画和特效专题</a></li>
  <li><a href="http://www.cocoachina.com/ios/20141022/10005.html">iOS开发之让你的应用“动”起来</a></li>
  <li><a href="http://www.jianshu.com/p/69449e6bdc14">关于App的一些迷思以及一些动画效果开源库的推荐</a></li>
  <li><a href="http://blog.csdn.net/iosevanhuang/article/details/14488239">CABasicAnimation的基本使用方法 移动·旋转·放大·缩小</a></li>
  <li><a href="http://www.objccn.io/issue-12-1/">动画解释</a></li>
</ul>

    <div class="declare">
        <div>

        </div>
    </div>
</article>
<!-- end #post__content -->

<div id="post__share">
  <a id="icon-twitter" class="fontello" href="https://twitter.com/intent/tweet?url=http://localhost:4000/2015/10/30/iOS-Animation-UIViewAndCoreAnimation.html&text=iOS动画和特效（一）UIView动画和CoreAnimation" target="_blank"></a>
  <a id="icon-cc" class="fontello" href="http://github.com/ZSMSimon" target="_blank"></a>
  <a id="icon-weibo" class="fontello" href="http://v.t.sina.com.cn/share/share.php?url=http://localhost:4000/2015/10/30/iOS-Animation-UIViewAndCoreAnimation.html&title=iOS动画和特效（一）UIView动画和CoreAnimation" target="_blank"></a>
    <!-- <div class="share-info">分享一下~</div> -->
</div>
<div id="qrcode" >
	<img src="http://localhost:4000/assets/images/qrcode.jpg" style="margin: 0 auto;display: block;" width="200" height="200" alt="">
</div>
<!-- end #post__share -->
<div id="disqus_thread" name="coolnameismy">
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink" target="_blank">Loading Disqus comments...</a>
</div>


            <!---->
    <!--<p id="copyright">Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>-->
    <!--&nbsp;&nbsp;|&nbsp;&nbsp;Theme <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll</a>-->
    <!--&nbsp;&nbsp;|&nbsp;&nbsp;Hosted on <a href="https://pages.github.com" target="_blank">Github</a></p>-->
      </div> <!-- end #pjax -->

      <div id="post__toc-trigger">
        <div id="post__toc">
          <span id="post__toc-title">Table of Contents</span>
          <ul id="post__toc-ul"></ul>
        </div>
      </div>
    </div> <!-- end #post -->

    <button id="js-fullscreen"><span id="icon-arrow" class="fontello"></span></button>

<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.pjax.js"></script>
<script src="/assets/js/nprogress.js"></script>
<script src="/assets/js/searchbox.js"></script>
<script src="/assets/js/script.js"></script>


    <script>
    //百度站点统计,排除localhost
    if(window.location.host.indexOf("localhost") ==-1 &&  window.location.host.indexOf("127.0.0.1") == -1){

        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?2c1583237ca3f5343d8dab0140019ca7";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    }
</script>
   </body>
 </html>