<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="baidu-site-verification" content="w9Akh6dPe4" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<!--[if lte IE 8]><meta http-equiv="refresh" content="0;url=/ie.html"><![endif]-->

<title>iOS动画和特效（六）swift动画库spring使用和代码拆解 | 曾绍明的博客</title>
<meta name="author" content="曾绍明">




<link rel="shortcut icon" href="" />

<link rel="stylesheet" type="text/css" href="/assets/css/style.css">

<link href="/pages/rss.xml" rel="alternate" title="曾绍明的博客" type="application/atom+xml">



  </head>
  <body>
        <aside id="sidebar">
  <nav id="tags">
    <a href="/index.html" id="avatar" style="background-image:url(https://avatars1.githubusercontent.com/u/15245912)"></a>

    <ul id="tags__ul">
      <li id="pl__all" class="tags__li tags-btn active">所有文章</li>
       
        <li id="技术" class="tags__li tags-btn">技术</li>
       
        <li id="web前端" class="tags__li tags-btn">web前端</li>
       
        <li id="专题" class="tags__li tags-btn">专题</li>
       
        <li id="iOS" class="tags__li tags-btn">iOS</li>
       
        <li id="生活" class="tags__li tags-btn">生活</li>
       
        <li id="react-native" class="tags__li tags-btn">react-native</li>
       
        <li id="其他" class="tags__li tags-btn">其他</li>
       
        <li id="IoT" class="tags__li tags-btn">IoT</li>
      
    </ul>

    <div id="tags__bottom">
      <a href="http://github.com/ZSMSimon" id="icon-github" class="tags-btn fontello" target="_blank"></a>
      <a href="/pages/rss.xml" id="icon-feed" class="tags-btn fontello" target="_blank"></a>
      <a href="mailto:ZSMSimon@163.com" id="icon-email" class="tags-btn fontello"></a>
    </div>
  </nav> <!-- end #tags -->

  <div id="posts-list">
    <form action="" id="search-form">
      <a href="/index.html" id="mobile-avatar" style="background-image:url(https://avatars1.githubusercontent.com/u/15245912)"></a>
      <!-- NOTE: input field is disabled by default -->
      <input id="search-input" type="text" placeholder="Search..." >
    </form>

    <nav id="pl__container">
    
      <a class="IoT pl__all" href="/2017/05/16/JavaScript-mqtt-temperaturedemo.html"><span class="pl__circle"></span><span class="pl__title">IoT技术选型及模型设计的思考</span><span class="pl__date">17/05/16</span></a>
    
      <a class="IoT pl__all" href="/2017/05/02/hello-nodemcu.html"><span class="pl__circle"></span><span class="pl__title">hello nodemcu</span><span class="pl__date">17/05/02</span></a>
    
      <a class="其他 pl__all" href="/2017/03/16/Recruitment.html"><span class="pl__circle"></span><span class="pl__title">阿里云iot事业部招聘信息</span><span class="pl__date">17/03/16</span></a>
    
      <a class="技术 pl__all" href="/2017/01/23/zhihu-live-a-hour-for-bluetooth-0.html"><span class="pl__circle"></span><span class="pl__title">知乎live：一小时蓝牙科普 文字整理版</span><span class="pl__date">17/01/23</span></a>
    
      <a class="web前端 pl__all" href="/2016/12/08/eslint-guide.html"><span class="pl__circle"></span><span class="pl__title">ESLint使用</span><span class="pl__date">16/12/08</span></a>
    
      <a class="其他 pl__all" href="/2016/12/06/how-to-fupan.html"><span class="pl__circle"></span><span class="pl__title">柳传志：我的复盘方法论</span><span class="pl__date">16/12/06</span></a>
    
      <a class="react-native pl__all" href="/2016/11/14/react-native-flux%E6%95%B0%E6%8D%AE%E6%B5%81.html"><span class="pl__circle"></span><span class="pl__title">flux数据流在rn中的使用</span><span class="pl__date">16/11/14</span></a>
    
      <a class="专题 pl__all" href="/2016/05/09/iOS-networking-0.html"><span class="pl__circle"></span><span class="pl__title">iOS 网络请求专题</span><span class="pl__date">16/05/09</span></a>
    
      <a class="iOS pl__all" href="/2016/04/03/iOS-JavaScriptCore.html"><span class="pl__circle"></span><span class="pl__title">iOS JavaScriptCore使用</span><span class="pl__date">16/04/03</span></a>
    
      <a class="iOS pl__all" href="/2016/04/02/iOS-3DTouch-3.html"><span class="pl__circle"></span><span class="pl__title">iOS 3D touch开发(三) Force Properties-按压力度</span><span class="pl__date">16/04/02</span></a>
    
      <a class="iOS pl__all" href="/2016/04/01/iOS-3DTouch-2.html"><span class="pl__circle"></span><span class="pl__title">iOS 3D touch开发(二) peek and pop - 预览和弹出</span><span class="pl__date">16/04/01</span></a>
    
      <a class="iOS pl__all" href="/2016/03/21/iOS-3DTouch-1.html"><span class="pl__circle"></span><span class="pl__title">iOS 3D touch开发(一) Home Screen Quick Actions</span><span class="pl__date">16/03/21</span></a>
    
      <a class="iOS pl__all" href="/2016/03/10/iOS-unit-test.html"><span class="pl__circle"></span><span class="pl__title">iOS单元测试</span><span class="pl__date">16/03/10</span></a>
    
      <a class="iOS pl__all" href="/2016/02/29/iOS-objc-styleguide.html"><span class="pl__circle"></span><span class="pl__title">iOS objc编程规范</span><span class="pl__date">16/02/29</span></a>
    
      <a class="iOS pl__all" href="/2016/02/13/ios-networking-5.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（五）网络请求中的cookie</span><span class="pl__date">16/02/13</span></a>
    
      <a class="iOS pl__all" href="/2016/02/09/ios-networking-4.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（四） http异步文件上传和下载以及进度指示</span><span class="pl__date">16/02/09</span></a>
    
      <a class="iOS pl__all" href="/2016/02/04/ios-networking-3.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（三） http异步请求和https认证</span><span class="pl__date">16/02/04</span></a>
    
      <a class="iOS pl__all" href="/2016/02/03/ios-networking-2.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（二） http异步队列请求</span><span class="pl__date">16/02/03</span></a>
    
      <a class="iOS pl__all" href="/2016/02/03/ios-networking-1.html"><span class="pl__circle"></span><span class="pl__title">iOS networking（一） http同步请求</span><span class="pl__date">16/02/03</span></a>
    
      <a class="react-native pl__all" href="/2016/02/02/react-native-demo.html"><span class="pl__circle"></span><span class="pl__title">react-native（二） 自己写的react-native学习demo和整理的tips</span><span class="pl__date">16/02/02</span></a>
    
      <a class="react-native pl__all" href="/2016/01/11/react-native-helloworld.html"><span class="pl__circle"></span><span class="pl__title">react-native（一） hello world</span><span class="pl__date">16/01/11</span></a>
    
      <a class="iOS pl__all" href="/2016/01/06/iOS-app-versions.html"><span class="pl__circle"></span><span class="pl__title">api如何设计才能支撑多个不同版本的app共存</span><span class="pl__date">16/01/06</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/31/playwith-imageToAscii.html"><span class="pl__circle"></span><span class="pl__title">那些好玩的nodejs插件 - 把图片转为ascii</span><span class="pl__date">15/12/31</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/10/fe-componentization.html"><span class="pl__circle"></span><span class="pl__title">前端开发框架 - seajs+handlebars模块化开发</span><span class="pl__date">15/12/10</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/06/fe-nginx-usage.html"><span class="pl__circle"></span><span class="pl__title">mac环境nginx的安装和使用</span><span class="pl__date">15/12/06</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/03/fe-js-handlebars.html"><span class="pl__circle"></span><span class="pl__title">handlerbars的使用及模板预编译</span><span class="pl__date">15/12/03</span></a>
    
      <a class="web前端 pl__all" href="/2015/12/01/fe-engineering-gulp.html"><span class="pl__circle"></span><span class="pl__title">gulp自动构建工具教程</span><span class="pl__date">15/12/01</span></a>
    
      <a class="web前端 pl__all" href="/2015/11/27/fe-environment.html"><span class="pl__circle"></span><span class="pl__title">前端开发工具和环境搭建</span><span class="pl__date">15/11/27</span></a>
    
      <a class="web前端 pl__all" href="/2015/11/26/rem-em-px.html"><span class="pl__circle"></span><span class="pl__title">css3属性rem的使用</span><span class="pl__date">15/11/26</span></a>
    
      <a class="生活 pl__all" href="/2015/11/26/mylift-github.html"><span class="pl__circle"></span><span class="pl__title">我每天都在github上做些什么</span><span class="pl__date">15/11/26</span></a>
    
      <a class="iOS pl__all" href="/2015/11/24/iOS-affine-transfermation-animation.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（七）仿射变换-CGAffineTransform</span><span class="pl__date">15/11/24</span></a>
    
      <a class="iOS pl__all" href="/2015/11/22/iOS-library-spring.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（六）swift动画库spring使用和代码拆解</span><span class="pl__date">15/11/22</span></a>
    
      <a class="iOS pl__all" href="/2015/11/16/iOS-Implicit-Animation.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（五）layer隐式动画</span><span class="pl__date">15/11/16</span></a>
    
      <a class="iOS pl__all" href="/2015/11/06/iOS-controller-transitioning.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（四）controller间的自定义过渡效果</span><span class="pl__date">15/11/06</span></a>
    
      <a class="iOS pl__all" href="/2015/11/01/iOS-MotionEffects.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（三）MotionEffects</span><span class="pl__date">15/11/01</span></a>
    
      <a class="iOS pl__all" href="/2015/10/30/iOS-UIKit-Dynamics.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（二）UIKit力学行为</span><span class="pl__date">15/10/30</span></a>
    
      <a class="iOS pl__all" href="/2015/10/30/iOS-Animation-UIViewAndCoreAnimation.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效（一）UIView动画和CoreAnimation</span><span class="pl__date">15/10/30</span></a>
    
      <a class="专题 pl__all" href="/2015/10/29/iOS-animation-0.html"><span class="pl__circle"></span><span class="pl__title">iOS动画和特效专题（零）- 大纲和计划</span><span class="pl__date">15/10/29</span></a>
    
      <a class="iOS pl__all" href="/2015/10/17/ios-webView.html"><span class="pl__circle"></span><span class="pl__title">UIWebView和WKWebView的使用及js交互</span><span class="pl__date">15/10/17</span></a>
    
      <a class="iOS pl__all" href="/2015/10/06/ios-swift-quick.html"><span class="pl__circle"></span><span class="pl__title">swift5分钟语法速记</span><span class="pl__date">15/10/06</span></a>
    
      <a class="iOS pl__all" href="/2015/09/20/ios-macro.html"><span class="pl__circle"></span><span class="pl__title">ios宏的使用和技巧</span><span class="pl__date">15/09/20</span></a>
    
      <a class="iOS pl__all" href="/2015/09/11/ios-BLE-4.html"><span class="pl__circle"></span><span class="pl__title">ios蓝牙开发（四）BabyBluetooth蓝牙库介绍</span><span class="pl__date">15/09/11</span></a>
    
      <a class="iOS pl__all" href="/2015/09/07/ios-BLE-3.html"><span class="pl__circle"></span><span class="pl__title">ios蓝牙开发（三）app作为外设被连接的实现</span><span class="pl__date">15/09/07</span></a>
    
      <a class="iOS pl__all" href="/2015/09/02/ios-draw-Graffiti-2.html"><span class="pl__circle"></span><span class="pl__title">ios绘图demo,做一个涂鸦板(下)</span><span class="pl__date">15/09/02</span></a>
    
      <a class="web前端 pl__all" href="/2015/08/29/go-deep-into-unsilder.js.html"><span class="pl__circle"></span><span class="pl__title">深入理解unslider.js源码</span><span class="pl__date">15/08/29</span></a>
    
      <a class="生活 pl__all" href="/2015/08/23/life-keyboardAndHHKB.html"><span class="pl__circle"></span><span class="pl__title">键盘那些事，hhkb开箱</span><span class="pl__date">15/08/23</span></a>
    
      <a class="技术 pl__all" href="/2015/08/22/github-ImagesUploadWebSite.html"><span class="pl__circle"></span><span class="pl__title">自己markdown博客的图床程序</span><span class="pl__date">15/08/22</span></a>
    
      <a class="iOS pl__all" href="/2015/08/19/ios-ThreadAndAsynchronization.html"><span class="pl__circle"></span><span class="pl__title">ios的线程和同步异步操作</span><span class="pl__date">15/08/19</span></a>
    
      <a class="iOS pl__all" href="/2015/08/14/ios-BLE-2.html"><span class="pl__circle"></span><span class="pl__title">ios蓝牙开发（二）ios连接外设的代码实现</span><span class="pl__date">15/08/14</span></a>
    
      <a class="iOS pl__all" href="/2015/07/26/ios-draw-Graffiti.html"><span class="pl__circle"></span><span class="pl__title">ios绘图demo,做一个涂鸦板(上)</span><span class="pl__date">15/07/26</span></a>
    
      <a class="iOS pl__all" href="/2015/07/25/ios-draw-base.html"><span class="pl__circle"></span><span class="pl__title">ios绘图基础</span><span class="pl__date">15/07/25</span></a>
    
      <a class="iOS pl__all" href="/2015/07/17/ios-BLE-1.html"><span class="pl__circle"></span><span class="pl__title">iOS蓝牙开发（一）蓝牙相关基础知识</span><span class="pl__date">15/07/17</span></a>
    
      <a class="专题 pl__all" href="/2015/07/17/ios-BLE-0.html"><span class="pl__circle"></span><span class="pl__title">iOS蓝牙的开发专题</span><span class="pl__date">15/07/17</span></a>
    
      <a class="技术 pl__all" href="/2015/07/07/mybatis.html"><span class="pl__circle"></span><span class="pl__title">MyBatis简单使用的demo</span><span class="pl__date">15/07/07</span></a>
    
      <a class="技术 pl__all" href="/2015/07/06/rabbitmq.html"><span class="pl__circle"></span><span class="pl__title">RabbitMQ使用</span><span class="pl__date">15/07/06</span></a>
    
      <a class="iOS pl__all" href="/2015/06/14/ios-library-masonry.html"><span class="pl__circle"></span><span class="pl__title">Masonry的使用</span><span class="pl__date">15/06/14</span></a>
    
      <a class="专题 pl__all" href="/2015/06/14/ios-library-0.html"><span class="pl__circle"></span><span class="pl__title">iOS中那些好用的第三方库</span><span class="pl__date">15/06/14</span></a>
    
      <a class="iOS pl__all" href="/2015/05/29/ios-develop-tool.html"><span class="pl__circle"></span><span class="pl__title">提高iOS开发效率的工具</span><span class="pl__date">15/05/29</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-4.html"><span class="pl__circle"></span><span class="pl__title">Spring 文件上传</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-3.html"><span class="pl__circle"></span><span class="pl__title">Spring- Hibernate数据基本操作</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-2.html"><span class="pl__circle"></span><span class="pl__title">Spring RestController 请求参数详解</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/spring-1.html"><span class="pl__circle"></span><span class="pl__title">Spring和hibernate的maven配置</span><span class="pl__date">15/05/28</span></a>
    
      <a class="技术 pl__all" href="/2015/05/28/tomcat-domain-name.html"><span class="pl__circle"></span><span class="pl__title">tomcat部署绑定多个域名</span><span class="pl__date">15/05/28</span></a>
    
      <a class="专题 pl__all" href="/2015/05/28/spring-0.html"><span class="pl__circle"></span><span class="pl__title">Spring4+hibernate专题</span><span class="pl__date">15/05/28</span></a>
    
      <a class="web前端 pl__all" href="/2015/04/29/css-selector.html"><span class="pl__circle"></span><span class="pl__title">css选择器的用法</span><span class="pl__date">15/04/29</span></a>
    
      <a class="技术 pl__all" href="/2014/02/12/how-to-deploy-a-blog-on-github-by-jekyll.html"><span class="pl__circle"></span><span class="pl__title">在Github上搭建Jekyll博客和创建主题</span><span class="pl__date">14/02/12</span></a>
    
      <a class="技术 pl__all" href="/2013/04/23/opensource-licenses.html"><span class="pl__circle"></span><span class="pl__title">五中常见的开源协议整理(BSD,Apache,GPL,LGPL,MIT)</span><span class="pl__date">13/04/23</span></a>
    
    </nav>
  </div> <!-- end #posts-list -->
</aside> <!-- end #sidebar -->
    <div id="post">
      <div id="pjax">
        <article id="post__content">
    <h1 id="post__title" data-identifier="20151122">iOS动画和特效（六）swift动画库spring使用和代码拆解</h1>
    <p><img src="https://camo.githubusercontent.com/4b086bf363f44f96e9384c06fbfc36610a98f9d3/687474703a2f2f636c2e6c792f696d6167652f3031325230443352337832672f646f776e6c6f61642f737072696e677377696674322e6a7067" alt="" /></p>

<h2 id="table-of-content">table of content</h2>

<ul>
  <li><a href="#spring介绍">spring介绍</a></li>
  <li><a href="#简单介绍使用spring实现动画效果">简单介绍使用spring实现动画效果</a></li>
  <li><a href="#spring代码拆解">spring代码拆解</a>
    <ul>
      <li>demo架构</li>
      <li>核心动画实现</li>
    </ul>
  </li>
</ul>

<h2 id="spring介绍">spring介绍</h2>

<p><a href="https://github.com/MengTo/Spring">spring</a> 是一个基于swift写的动画库，是swift目前最常用的动画库 github6000+</p>

<h3 id="spring优点">spring优点：</h3>

<ul>
  <li>用简单的语法封装了ios UIView Animation的方法，使用起来减少了代码量</li>
  <li>添加了几种常见的动画效果如shake pop等动画</li>
  <li>支持直接在storyboard中通过配置加入动画效果</li>
</ul>

<h3 id="安装">安装：</h3>

<ul>
  <li>手动安装：直接将项目中的spring文件夹拖入你的项目</li>
  <li>pods：</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    use_frameworks!
    pod 'Spring', :git =&gt; 'https://github.com/MengTo/Spring.git', :branch =&gt; 'swift2'
</code></pre></div></div>

<h2 id="简单介绍使用spring实现动画效果">简单介绍使用spring实现动画效果</h2>

<p>spring实现动画效果有2种方式，一种是在storyboard里面配置，我个人来说不喜欢这种方式，iOS开发不分前端后端，动画实现放在界面中其实维护起来容易出错，并且不利于代码重用，所以我就不介绍storyboard的实现方式，有兴趣的自己看spring主页。spring提供的demo里面，code和option弹出vc使用的就是storyboard配置的方式。</p>

<h3 id="使用spring动画示例">使用spring动画示例：</h3>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
     <span class="c1">//1：需要让view继承自SpringView</span>
     <span class="k">var</span> <span class="nv">ballView</span><span class="p">:</span> <span class="kt">SpringView</span><span class="o">!</span>

     <span class="c1">//2：配置动画的运行参数</span>
     <span class="n">ballView</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="s">"Shake"</span> <span class="c1">//配置动画方式</span>
     
     <span class="c1">//配置运动曲线 这里类似于先慢后快的运动，除了原生的运动曲线外，Spring库还添加了许多自定义的运动曲线</span>
     <span class="n">ballView</span><span class="o">.</span><span class="n">curve</span> <span class="o">=</span> <span class="s">"EaseOut"</span> 

     <span class="c1">//3：执行动画</span>
     <span class="n">ballView</span><span class="o">.</span><span class="nf">animate</span><span class="p">()</span>

</code></pre></div></div>

<p>这样就动了起来，如图：</p>

<p><img src="" alt="" /></p>

<h3 id="可选的配置参数">可选的配置参数</h3>

<p>Animation：动画类型</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    shake
    pop
    morph
    squeeze
    wobble
    swing
    flipX
    flipY
    fall
    squeezeLeft
    squeezeRight
    squeezeDown
    squeezeUp
    slideLeft
    slideRight
    slideDown
    slideUp
    fadeIn
    fadeOut
    fadeInLeft
    fadeInRight
    fadeInDown
    fadeInUp
    zoomIn
    zoomOut
    flash
</code></pre></div></div>

<p>Curve：运动曲线</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    EaseIn,
    EaseOut,
    EaseInOut,
    Linear,
    Spring,
    EaseInSine,
    EaseOutSine,
    EaseInOutSine,
    EaseInQuad,
    EaseOutQuad,
    EaseInOutQuad,
    EaseInCubic,
    EaseOutCubic,
    EaseInOutCubic,
    EaseInQuart,
    EaseOutQuart,
    EaseInOutQuart,
    EaseInQuint,
    EaseOutQuint,
    EaseInOutQuint,
    EaseInExpo,
    EaseOutExpo,
    EaseInOutExpo,
    EaseInCirc,
    EaseOutCirc,
    EaseInOutCirc,
    EaseInBack,
    EaseOutBack,
    EaseInOutBack
</code></pre></div></div>

<p>Properties：属性</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    force
    duration
    delay
    damping
    velocity
    repeatCount
    scale
    x
    y
    rotate

</code></pre></div></div>

<p><strong>注意，并不是所有的属性都可以同时设置使用的</strong></p>

<h2 id="spring动画的实现-序">spring动画的实现-序</h2>

<p>我们简单的看一下spring动画库中的代码文件。spring1.0.3版本，spring文件夹有30个文件，其中居然还存在一些基本没用的文件，还有些文件的作用我也没仔细看。这里主要分析下spring动画实现部分的代码，最核心的类只有就3个文件</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">//核心动画效果实现类</span>
<span class="kt">Spring</span>

<span class="c1">//UIView.animateWithDuration的动画的简单封装</span>
<span class="kt">SpringAnimation</span>

<span class="c1">//使用动画的入口类，本身继承自UIView，自己使用时可以通过继承SpringView，</span>
<span class="c1">//然后就可以使用spring动画特效，同时也支持Storyboard配置动画属性</span>
<span class="kt">SpringView</span>

</code></pre></div></div>

<p>说实话个人觉得这个库写的很啰嗦，spring里面30个文件，正真核心的就3个。使用动画也很不方便，还得继承SpringView，这个算是侵入式的编程，就像java中strcts和spring的controller区别一样明显。要是我来写一个动画库，1个文件把动效封装一下就好了，用静态方法或是扩展方法都挺好，也不会去支持通过storyboard去配置动画。我真的会去写一个哦，计划16年写吧。15年还得更新更新babybluetooth蓝牙库。</p>

<p>虽然这么说spring框架，但其实他里面的动画效果和时间函数还是挺好的，作者好像就是设计师出生，里面每个特效的参数设置的极为合理。后面我来拆一拆它每一个动画效果和时间函数的实现。</p>

<h2 id="动画效果实现">动画效果实现</h2>
<blockquote>
  <p>本文中把所有spring中的动画特效类型使用原生方法实现一次</p>
</blockquote>

<p>动画效果有这些</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    shake //晃动
    pop
    morph
    squeeze
    wobble
    swing
    flipX
    flipY
    fall
    squeezeLeft
    squeezeRight
    squeezeDown
    squeezeUp
    slideLeft
    slideRight
    slideDown
    slideUp
    fadeIn
    fadeOut
    fadeInLeft
    fadeInRight
    fadeInDown
    fadeInUp
    zoomIn
    zoomOut
    flash

</code></pre></div></div>

<p>这段介绍暂时忽略动画的时间函数，都已线性时间函数为例</p>

<h3 id="shake">shake</h3>

<p>shake是一个关键帧动画，通过定义左右左右2次的数值变化实现晃动效果，这个效果使用原生代码实现如下</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
        <span class="k">let</span> <span class="nv">force</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">let</span> <span class="nv">duration</span> <span class="o">=</span> <span class="mf">0.7</span>
        <span class="k">let</span> <span class="nv">delay</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">let</span> <span class="nv">repeatCount</span><span class="p">:</span><span class="kt">Float</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">let</span> <span class="nv">timeFunction</span> <span class="o">=</span> <span class="kt">CAMediaTimingFunction</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="n">kCAMediaTimingFunctionLinear</span><span class="p">)</span>
        
        <span class="k">let</span> <span class="nv">animation</span> <span class="o">=</span> <span class="kt">CAKeyframeAnimation</span><span class="p">()</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="s">"position.x"</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">30*</span><span class="n">force</span><span class="p">,</span> <span class="o">-</span><span class="mf">30*</span><span class="n">force</span><span class="p">,</span> <span class="mf">30*</span><span class="n">force</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">keyTimes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">timingFunction</span> <span class="o">=</span>  <span class="n">timeFunction</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">additive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="n">repeatCount</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="kt">CACurrentMediaTime</span><span class="p">()</span> <span class="o">+</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
        <span class="n">ballView</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">animation</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"shake"</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="pop">pop</h3>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
   <span class="k">let</span> <span class="nv">force</span><span class="p">:</span><span class="kt">Float</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">let</span> <span class="nv">duration</span> <span class="o">=</span> <span class="mf">0.7</span>
        <span class="k">let</span> <span class="nv">delay</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">let</span> <span class="nv">repeatCount</span><span class="p">:</span><span class="kt">Float</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">let</span> <span class="nv">timeFunction</span> <span class="o">=</span> <span class="kt">CAMediaTimingFunction</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="n">kCAMediaTimingFunctionLinear</span><span class="p">)</span>
      
        <span class="k">let</span> <span class="nv">animation</span> <span class="o">=</span> <span class="kt">CAKeyframeAnimation</span><span class="p">()</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="s">"transform.scale"</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">force</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">force</span><span class="p">,</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">force</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">keyTimes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="n">timeFunction</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">additive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="n">repeatCount</span>
        <span class="n">animation</span><span class="o">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="kt">CACurrentMediaTime</span><span class="p">()</span> <span class="o">+</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">animation</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"pop"</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="morph">morph</h3>

<p>这个词中文应该是变形的意思，他是实现是做了x和y轴的scale变化</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="k">let</span> <span class="nv">morphX</span> <span class="o">=</span> <span class="kt">CAKeyframeAnimation</span><span class="p">()</span>
    <span class="n">morphX</span><span class="o">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="s">"transform.scale.x"</span>
    <span class="n">morphX</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.3</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">morphX</span><span class="o">.</span><span class="n">keyTimes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">morphX</span><span class="o">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="nf">getTimingFunction</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
    <span class="n">morphX</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">morphX</span><span class="o">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="n">repeatCount</span>
    <span class="n">morphX</span><span class="o">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="kt">CACurrentMediaTime</span><span class="p">()</span> <span class="o">+</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">morphX</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"morphX"</span><span class="p">)</span>

    <span class="k">let</span> <span class="nv">morphY</span> <span class="o">=</span> <span class="kt">CAKeyframeAnimation</span><span class="p">()</span>
    <span class="n">morphY</span><span class="o">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="s">"transform.scale.y"</span>
    <span class="n">morphY</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">morphY</span><span class="o">.</span><span class="n">keyTimes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">morphY</span><span class="o">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="nf">getTimingFunction</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
    <span class="n">morphY</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">morphY</span><span class="o">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="n">repeatCount</span>
    <span class="n">morphY</span><span class="o">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="kt">CACurrentMediaTime</span><span class="p">()</span> <span class="o">+</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">morphY</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"morphY"</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="squeeze">squeeze</h3>

<p>挤压效果，这个效果和上面的很类似，只有x和y的scale参数不一样。注意这个force参数设置的位置还是很有讲究的</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">//区别</span>
 <span class="n">morphX</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
 <span class="n">morphY</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

</code></pre></div></div>

<h3 id="wobble">wobble</h3>

<p>摆动效果，实际上类似于shake并在shake中带一些旋转</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="k">let</span> <span class="nv">animation</span> <span class="o">=</span> <span class="kt">CAKeyframeAnimation</span><span class="p">()</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="s">"transform.rotation"</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">keyTimes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">additive</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="kt">CACurrentMediaTime</span><span class="p">()</span> <span class="o">+</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">animation</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"wobble"</span><span class="p">)</span>

    <span class="k">let</span> <span class="nv">x</span> <span class="o">=</span> <span class="kt">CAKeyframeAnimation</span><span class="p">()</span>
    <span class="n">x</span><span class="o">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="s">"position.x"</span>
    <span class="n">x</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">30*</span><span class="n">force</span><span class="p">,</span> <span class="o">-</span><span class="mf">30*</span><span class="n">force</span><span class="p">,</span> <span class="mf">30*</span><span class="n">force</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span><span class="o">.</span><span class="n">keyTimes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">x</span><span class="o">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="nf">getTimingFunction</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">additive</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="n">x</span><span class="o">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="n">repeatCount</span>
    <span class="n">x</span><span class="o">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="kt">CACurrentMediaTime</span><span class="p">()</span> <span class="o">+</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"x"</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="swing">swing</h3>

<p>这个词翻译过来也是摆动，我的英文也没那么好，不能给大家形象的解释swing和wobble区别。这里就当不同的摆动效果吧。spring中swing的摆动是只旋转</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="k">let</span> <span class="nv">animation</span> <span class="o">=</span> <span class="kt">CAKeyframeAnimation</span><span class="p">()</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="s">"transform.rotation"</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">force</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">keyTimes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">additive</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="kt">CACurrentMediaTime</span><span class="p">()</span> <span class="o">+</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">animation</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"swing"</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="flipxflipy">FlipX,FlipY</h3>

<p>这两个动画是分别使用3D中x和y轴转换</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="k">var</span> <span class="nv">perspective</span> <span class="o">=</span> <span class="kt">CATransform3DIdentity</span>
    <span class="n">perspective</span><span class="o">.</span><span class="n">m34</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">layer</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span>

    <span class="k">let</span> <span class="nv">animation</span> <span class="o">=</span> <span class="kt">CABasicAnimation</span><span class="p">()</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="s">"transform"</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">fromValue</span> <span class="o">=</span> <span class="kt">NSValue</span><span class="p">(</span><span class="kt">CATransform3D</span><span class="p">:</span>
    <span class="kt">CATransform3DMakeRotation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c1">//FlipX使用这句</span>
    <span class="c1">//animation.toValue = NSValue(CATransform3D:</span>
        <span class="kt">CATransform3DConcat</span><span class="p">(</span><span class="n">perspective</span><span class="p">,</span><span class="kt">CATransform3DMakeRotation</span><span class="p">(</span><span class="kt">CGFloat</span><span class="p">(</span><span class="kt">M_PI</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="c1">//FlipY使用这句</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="kt">NSValue</span><span class="p">(</span><span class="kt">CATransform3D</span><span class="p">:</span>
    <span class="kt">CATransform3DConcat</span><span class="p">(</span><span class="n">perspective</span><span class="p">,</span><span class="kt">CATransform3DMakeRotation</span><span class="p">(</span><span class="kt">CGFloat</span><span class="p">(</span><span class="kt">M_PI</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>

    <span class="n">animation</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="kt">CACurrentMediaTime</span><span class="p">()</span> <span class="o">+</span> <span class="kt">CFTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="n">animation</span><span class="o">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="nf">getTimingFunction</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
    <span class="n">layer</span><span class="o">.</span><span class="nf">addAnimation</span><span class="p">(</span><span class="n">animation</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="s">"3d"</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="fall">fall</h3>

<p>这个方法是使用animateWithDuration和CGAffineTransformMakeTranslation实现的,做了y轴下降和旋转</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
   <span class="kt">UIView</span><span class="o">.</span><span class="nf">animateWithDuration</span><span class="p">(</span><span class="kt">NSTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span> <span class="nv">delay</span><span class="p">:</span> <span class="kt">NSTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">),</span> <span class="nv">usingSpringWithDamping</span><span class="p">:</span> <span class="n">damping</span><span class="p">,</span> <span class="nv">initialSpringVelocity</span><span class="p">:</span> <span class="n">velocity</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="kt">CurveLinear</span><span class="p">,</span><span class="o">.</span><span class="kt">AllowUserInteraction</span><span class="p">],</span> <span class="nv">animations</span><span class="p">:</span> <span class="p">{</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
            <span class="k">let</span> <span class="nv">translate</span> <span class="o">=</span> <span class="kt">CGAffineTransformMakeTranslation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">rotate</span> <span class="o">=</span> <span class="kt">CGAffineTransformMakeRotation</span><span class="p">(</span><span class="mi">15</span> <span class="o">*</span> <span class="kt">CGFloat</span><span class="p">(</span><span class="kt">M_PI</span> <span class="o">/</span> <span class="mi">180</span><span class="p">))</span>
            <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="kt">CGAffineTransformConcat</span><span class="p">(</span><span class="n">translate</span><span class="p">,</span> <span class="n">rotate</span><span class="p">)</span>
        <span class="p">},</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="squeezeleftsqueezerightsqueezedownsqueezeupslideleftsliderightslidedownslideup">squeezeLeft,squeezeRight,squeezeDown,squeezeUp,slideLeft,slideRight,slideDown,slideUp</h3>

<p>这组方法是上下左右移动，slideLeft就是普通的移动，squeeze开头的会在移动中根据方向改变x或y的sacle，是效果更加逼真一些</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
 <span class="kt">UIView</span><span class="o">.</span><span class="nf">animateWithDuration</span><span class="p">(</span><span class="kt">NSTimeInterval</span><span class="p">(</span><span class="n">duration</span><span class="p">),</span> <span class="nv">delay</span><span class="p">:</span> <span class="kt">NSTimeInterval</span><span class="p">(</span><span class="n">delay</span><span class="p">),</span> <span class="nv">usingSpringWithDamping</span><span class="p">:</span> <span class="n">damping</span><span class="p">,</span> <span class="nv">initialSpringVelocity</span><span class="p">:</span> <span class="n">velocity</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="kt">CurveLinear</span><span class="p">,</span><span class="o">.</span><span class="kt">AllowUserInteraction</span><span class="p">],</span> <span class="nv">animations</span><span class="p">:</span> <span class="p">{</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
            <span class="k">let</span> <span class="nv">translate</span> <span class="o">=</span> <span class="kt">CGAffineTransformMakeTranslation</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="c1">//slide开头就不需要scale效果</span>
            <span class="k">let</span> <span class="nv">scale</span> <span class="o">=</span> <span class="kt">CGAffineTransformMakeScale</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="kt">CGAffineTransformConcat</span><span class="p">(</span><span class="n">translate</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
            <span class="p">},</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="fadeinfadeoutfadeinleftfadeinrightfadeindownfadeinup">fadeIn，fadeOut，fadeInLeft，fadeInRight，fadeInDown，fadeInUp</h3>

<p>这组动画是淡入淡出效果。后面四个带方向的是淡入淡出时添加方向位移效果。代码不写了，都一样的东西，就比移动的动画代码增加了一个alpha属性的修改。这组动画任然使用animateWithDuration完成</p>

<h3 id="zoominzoomout">zoomIn，zoomOut</h3>

<p>方法缩小，但是在spring中附加了淡入淡出的效果。这个命名就和之前的不符合了，按照之前的方法命名习惯，这里应该分成4个方法，普通的和淡入淡出的版本</p>

<h3 id="flash">flash</h3>

<p>就是repeat几次，fadeIn，fadeOut，fadeIn，fadeOut，好像在闪烁一样。这个效果spring根本没做好。</p>

<h3 id="动画类型总结">动画类型总结</h3>

<p>基本动画类型就这么几种，关键帧动画，基本动画，CATransform3D和CATransform。整体来说spring的动画类型也没有很多，有的动画效果参数设置的还不错，有的动画也没做好，有很多优化的空间。</p>

<h2 id="时间函数实现">时间函数实现</h2>

<p>spring动画库中扩充了原生时间函数的类型，原来只有EaseIn，EaseOut，EaseInOut，Linear四种。在spring中有很多很多种类，也有很多相似，名称也不知道如何翻译合适。我把所有的时间函数二次贝塞尔曲线画出来，大家自己看吧。</p>

<p>使用一个在线贝塞尔曲线查看工具：<a href="http://labs.pufen.net/cubic-bezier">cubic-bezier-tool</a></p>

<p>下方有个去曲线库，旁边点击导入，把下面的json导入进去。之后就可以选择每个曲线点击执行查看运动效果了，很方便。</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="s2">"ease"</span><span class="p">:</span><span class="w"> </span><span class="s2">".25,.1,.25,1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"linear"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0,0,1,1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ease-in"</span><span class="p">:</span><span class="w"> </span><span class="s2">".42,0,1,1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ease-out"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0,0,.58,1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ease-in-out"</span><span class="p">:</span><span class="w"> </span><span class="s2">".42,0,.58,1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInSine"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.47, 0, 0.745, 0.715"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseOutSine"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.39, 0.575, 0.565, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInOutSine"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.445, 0.05, 0.55, 0.95"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInQuad"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.55, 0.085, 0.68, 0.53"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseOutQuad"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.25, 0.46, 0.45, 0.94"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInOutQuad"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.455, 0.03, 0.515, 0.955"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInCubic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.55, 0.055, 0.675, 0.19"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseOutCubic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.215, 0.61, 0.355, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInOutCubic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.645, 0.045, 0.355, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInQuart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.895, 0.03, 0.685, 0.22"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseOutQuart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.165, 0.84, 0.44, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInOutQuart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.77, 0, 0.175, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInQuint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.755, 0.05, 0.855, 0.06"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseOutQuint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.23, 1, 0.32, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInOutQuint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.86, 0, 0.07, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInExpo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.95, 0.05, 0.795, 0.035"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseOutExpo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.19, 1, 0.22, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInOutExpo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1, 0, 0, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInCirc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.6, 0.04, 0.98, 0.335"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseOutCirc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.075, 0.82, 0.165, 1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInOutCirc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.785, 0.135, 0.15, 0.86"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInBack"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.6, -0.28, 0.735, 0.045"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseOutBack"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.175, 0.885, 0.32, 1.275"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"EaseInOutBack"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.68, -0.55, 0.265, 1.55"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div>

<p>所有时间曲线的函数图如下</p>

<p><img src="http://localhost:4000/assets/uploads/springsCAMediaTimingFunction.png" alt="" /></p>

<h2 id="spring-library中我们能学到的内容总结">spring library中我们能学到的内容总结</h2>

<ul>
  <li>最值得我们学习的地方：spring中定义的各种动画效果和时间函数的实现，所有不是全都很有用，但是还是有很多好用的地方</li>
  <li>demo里面有很多细节，比如modal页面中presention和presenting的交互，通过<code class="highlighter-rouge">UIApplication.sharedApplication().sendAction("minimizeView:", to: nil, from: self, forEvent: nil)</code> 和委托实现</li>
  <li>其他还有很多细节，自己看源码去吧</li>
</ul>

<h2 id="最后">最后</h2>

<p>感谢收看，如果对大家有帮助，请<a href="https://github.com/coolnameismy">github上follow和star</a>，本文发布在<a href="https://zsmsimon.github.io/">刘彦玮的技术博客</a>，转载请注明出处</p>

    <div class="declare">
        <div>

        </div>
    </div>
</article>
<!-- end #post__content -->

<div id="post__share">
  <a id="icon-twitter" class="fontello" href="https://twitter.com/intent/tweet?url=http://localhost:4000/2015/11/22/iOS-library-spring.html&text=iOS动画和特效（六）swift动画库spring使用和代码拆解" target="_blank"></a>
  <a id="icon-cc" class="fontello" href="http://github.com/ZSMSimon" target="_blank"></a>
  <a id="icon-weibo" class="fontello" href="http://v.t.sina.com.cn/share/share.php?url=http://localhost:4000/2015/11/22/iOS-library-spring.html&title=iOS动画和特效（六）swift动画库spring使用和代码拆解" target="_blank"></a>
    <!-- <div class="share-info">分享一下~</div> -->
</div>
<div id="qrcode" >
	<img src="http://localhost:4000/assets/images/qrcode.jpg" style="margin: 0 auto;display: block;" width="200" height="200" alt="">
</div>
<!-- end #post__share -->
<div id="disqus_thread" name="coolnameismy">
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink" target="_blank">Loading Disqus comments...</a>
</div>


            <!---->
    <!--<p id="copyright">Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>-->
    <!--&nbsp;&nbsp;|&nbsp;&nbsp;Theme <a href="https://github.com/P233/3-Jekyll" target="_blank">3-Jekyll</a>-->
    <!--&nbsp;&nbsp;|&nbsp;&nbsp;Hosted on <a href="https://pages.github.com" target="_blank">Github</a></p>-->
      </div> <!-- end #pjax -->

      <div id="post__toc-trigger">
        <div id="post__toc">
          <span id="post__toc-title">Table of Contents</span>
          <ul id="post__toc-ul"></ul>
        </div>
      </div>
    </div> <!-- end #post -->

    <button id="js-fullscreen"><span id="icon-arrow" class="fontello"></span></button>

<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.pjax.js"></script>
<script src="/assets/js/nprogress.js"></script>
<script src="/assets/js/searchbox.js"></script>
<script src="/assets/js/script.js"></script>


    <script>
    //百度站点统计,排除localhost
    if(window.location.host.indexOf("localhost") ==-1 &&  window.location.host.indexOf("127.0.0.1") == -1){

        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?2c1583237ca3f5343d8dab0140019ca7";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    }
</script>
   </body>
 </html>